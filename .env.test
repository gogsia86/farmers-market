# ðŸ§ª TEST ENVIRONMENT CONFIGURATION
# Farmers Market Platform - Integration Test Database
# This file is used by Jest for integration tests

# ============================================================================
# DATABASE CONFIGURATION - TEST DATABASE
# ============================================================================

# Test database - separate from development/production
# Uses same PostgreSQL instance but different database name
DATABASE_URL="postgresql://postgres:postgres@127.0.0.1:5432/farmersmarket_test"

# Alternative: Use Docker container for tests
# DATABASE_URL="postgresql://test_user:test_password@localhost:5433/farmersmarket_test"

# ============================================================================
# AUTHENTICATION & SECURITY - TEST VALUES
# ============================================================================

# NextAuth Configuration (Test)
NEXTAUTH_URL="http://localhost:3001"
NEXTAUTH_SECRET="test-secret-key-for-integration-tests-only-not-for-production"

# ============================================================================
# EXTERNAL SERVICES - MOCKED/TEST ENDPOINTS
# ============================================================================

# Email Service (test mode)
EMAIL_FROM="test@farmersmarket.test"
EMAIL_SERVER="smtp://test:test@localhost:1025"

# Payment Gateway (test mode)
STRIPE_SECRET_KEY="sk_test_mock_key"
STRIPE_PUBLISHABLE_KEY="pk_test_mock_key"
STRIPE_WEBHOOK_SECRET="whsec_test_mock_secret"

# Cloud Storage (test/mock)
AWS_ACCESS_KEY_ID="test-access-key"
AWS_SECRET_ACCESS_KEY="test-secret-key"
AWS_REGION="us-east-1"
AWS_S3_BUCKET="farmersmarket-test-uploads"

# ============================================================================
# APPLICATION SETTINGS - TEST MODE
# ============================================================================

NODE_ENV="test"
NEXT_PUBLIC_APP_URL="http://localhost:3001"
NEXT_PUBLIC_API_URL="http://localhost:3001/api"

# Feature Flags (all enabled for testing)
FEATURE_REALTIME_UPDATES="true"
FEATURE_AI_RECOMMENDATIONS="true"
FEATURE_ADVANCED_ANALYTICS="true"

# Rate Limiting (relaxed for tests)
RATE_LIMIT_WINDOW="60000"
RATE_LIMIT_MAX_REQUESTS="1000"

# ============================================================================
# REDIS CACHE - TEST INSTANCE
# ============================================================================

REDIS_URL="redis://localhost:6379/15"  # Use DB 15 for tests
REDIS_PASSWORD=""
REDIS_TLS_ENABLED="false"

# ============================================================================
# MONITORING & LOGGING - TEST MODE
# ============================================================================

LOG_LEVEL="error"  # Only errors in tests for cleaner output
TELEMETRY_ENABLED="false"
SENTRY_DSN=""  # Don't send test errors to Sentry

# OpenTelemetry (disabled for tests)
OTEL_EXPORTER_OTLP_ENDPOINT=""
OTEL_SERVICE_NAME="farmersmarket-test"

# ============================================================================
# TEST-SPECIFIC SETTINGS
# ============================================================================

# Test execution settings
TEST_TIMEOUT="30000"  # 30 second timeout for tests
TEST_PARALLEL_WORKERS="4"  # Number of parallel test workers

# Test data cleanup
AUTO_CLEANUP_TEST_DATA="true"
PRESERVE_TEST_DATA="false"

# Mock services
USE_MOCK_EMAIL="true"
USE_MOCK_PAYMENT="true"
USE_MOCK_STORAGE="true"

# ============================================================================
# NOTES
# ============================================================================

# 1. This file should NOT be committed to version control with real credentials
# 2. Each developer should have their own .env.test locally
# 3. CI/CD should inject test credentials from secure storage
# 4. Test database should be reset between test runs for consistency
# 5. Use separate Redis DB number (15) to avoid conflicts with dev data

# ============================================================================
# SETUP INSTRUCTIONS
# ============================================================================

# To set up test database:
# 1. Create test database: createdb farmersmarket_test
# 2. Run migrations: npm run migrate:test
# 3. (Optional) Seed test data: npm run seed:test
# 4. Run tests: npm test

# To reset test database:
# dropdb farmersmarket_test && createdb farmersmarket_test && npm run migrate:test
