{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\security\\__tests__\\security.service.test.ts","mappings":"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","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\security\\__tests__\\security.service.test.ts"],"sourcesContent":["import { describe, expect, it } from \"@jest/globals\";\nimport { SecurityService } from \"../security.service\";\n\ndescribe(\"SecurityService\", () => {\n  describe(\"sanitizeInput\", () => {\n    it(\"should sanitize HTML tags\", () => {\n      const input = \"<script>alert('xss')</script>\";\n      const result = SecurityService.sanitizeInput(input);\n      expect(result).toBe(\n        \"&lt;script&gt;alert(&#x27;xss&#x27;)&lt;&#x2F;script&gt;\"\n      );\n    });\n\n    it(\"should sanitize quotes\", () => {\n      const input = 'Test \"quoted\" text';\n      const result = SecurityService.sanitizeInput(input);\n      expect(result).toContain(\"&quot;\");\n    });\n  });\n\n  describe(\"isValidEmail\", () => {\n    it(\"should validate correct email\", () => {\n      expect(SecurityService.isValidEmail(\"test@example.com\")).toBe(true);\n    });\n\n    it(\"should reject invalid email\", () => {\n      expect(SecurityService.isValidEmail(\"invalid-email\")).toBe(false);\n      expect(SecurityService.isValidEmail(\"test@\")).toBe(false);\n      expect(SecurityService.isValidEmail(\"@example.com\")).toBe(false);\n    });\n  });\n\n  describe(\"isValidPhone\", () => {\n    it(\"should validate correct phone numbers\", () => {\n      expect(SecurityService.isValidPhone(\"(503) 555-1234\")).toBe(true);\n      expect(SecurityService.isValidPhone(\"503-555-1234\")).toBe(true);\n      expect(SecurityService.isValidPhone(\"5035551234\")).toBe(true);\n    });\n\n    it(\"should reject invalid phone numbers\", () => {\n      expect(SecurityService.isValidPhone(\"123\")).toBe(false);\n      expect(SecurityService.isValidPhone(\"abc-def-ghij\")).toBe(false);\n    });\n  });\n\n  describe(\"isStrongPassword\", () => {\n    it(\"should validate strong password\", () => {\n      const result = SecurityService.isStrongPassword(\"Test123!@#\");\n      expect(result.valid).toBe(true);\n      expect(result.errors).toHaveLength(0);\n    });\n\n    it(\"should reject weak passwords\", () => {\n      const result = SecurityService.isStrongPassword(\"weak\");\n      expect(result.valid).toBe(false);\n      expect(result.errors.length).toBeGreaterThan(0);\n    });\n\n    it(\"should require minimum length\", () => {\n      const result = SecurityService.isStrongPassword(\"Test1!\");\n      expect(result.valid).toBe(false);\n      expect(result.errors).toContain(\"Password must be at least 8 characters\");\n    });\n  });\n\n  describe(\"validateFileUpload\", () => {\n    it(\"should validate correct file\", () => {\n      const file = {\n        size: 1024 * 1024, // 1MB\n        type: \"image/jpeg\",\n      };\n\n      const result = SecurityService.validateFileUpload(file, {\n        maxSize: 5 * 1024 * 1024, // 5MB\n        allowedTypes: [\"image/jpeg\", \"image/png\"],\n      });\n\n      expect(result.valid).toBe(true);\n    });\n\n    it(\"should reject file that is too large\", () => {\n      const file = {\n        size: 10 * 1024 * 1024, // 10MB\n        type: \"image/jpeg\",\n      };\n\n      const result = SecurityService.validateFileUpload(file, {\n        maxSize: 5 * 1024 * 1024, // 5MB\n        allowedTypes: [\"image/jpeg\"],\n      });\n\n      expect(result.valid).toBe(false);\n      expect(result.error).toContain(\"File too large\");\n    });\n\n    it(\"should reject invalid file type\", () => {\n      const file = {\n        size: 1024,\n        type: \"application/exe\",\n      };\n\n      const result = SecurityService.validateFileUpload(file, {\n        maxSize: 5 * 1024 * 1024,\n        allowedTypes: [\"image/jpeg\", \"image/png\"],\n      });\n\n      expect(result.valid).toBe(false);\n      expect(result.error).toContain(\"Invalid file type\");\n    });\n  });\n});\n\r\n"],"version":3}