{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\__tests__\\farm.service.test.ts","mappings":"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","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\__tests__\\farm.service.test.ts"],"sourcesContent":["/**\r\n * ðŸ§¬ DIVINE TEST SUITE: Farm Service\r\n * ðŸ“š Reference: 05_TESTING_SECURITY_DIVINITY.instructions.md\r\n * ðŸŒ¾ Domain: Agricultural Service Layer\r\n *\r\n * Tests for complete CRUD operations with caching integration\r\n */\r\n\r\nimport { AgriculturalCache } from \"@/lib/cache/agricultural-cache\";\r\nimport { database } from \"@/lib/database\";\r\nimport { afterEach, beforeEach, describe, expect, it } from \"@jest/globals\";\r\nimport type {\r\n  FarmStatus,\r\n  FarmingPractice,\r\n  ProductCategory,\r\n} from \"@prisma/client\";\r\nimport {\r\n  createFarmService,\r\n  deleteFarmService,\r\n  getFarmById,\r\n  getFarmBySlug,\r\n  listFarmsService,\r\n  searchFarmsService,\r\n  updateFarmService,\r\n} from \"../farm.service\";\r\n\r\n// Mock the database\r\njest.mock(\"@/lib/database\", () => ({\r\n  database: {\r\n    farm: {\r\n      create: jest.fn(),\r\n      findUnique: jest.fn(),\r\n      update: jest.fn(),\r\n      findMany: jest.fn(),\r\n      count: jest.fn(),\r\n    },\r\n    user: {\r\n      findUnique: jest.fn(),\r\n    },\r\n  },\r\n}));\r\n\r\n// Mock the cache - must match the exact import path in farm.service.ts\r\njest.mock(\"@/lib/cache/agricultural-cache\", () => ({\r\n  AgriculturalCache: {\r\n    getFarm: jest.fn(),\r\n    cacheFarm: jest.fn(),\r\n    invalidateFarm: jest.fn(),\r\n    getProduct: jest.fn(),\r\n    cacheProduct: jest.fn(),\r\n    invalidateProduct: jest.fn(),\r\n  },\r\n}));\r\n\r\ndescribe(\"Farm Service - CRUD Operations\", () => {\r\n  const mockUserId = \"user-123\";\r\n  const mockFarmId = \"farm-456\";\r\n  const mockSlug = \"test-organic-farm\";\r\n\r\n  const mockUser = {\r\n    id: mockUserId,\r\n    email: \"farmer@example.com\",\r\n    name: \"Test Farmer\",\r\n    role: \"FARMER\" as const,\r\n  };\r\n\r\n  const mockFarm = {\r\n    id: mockFarmId,\r\n    slug: mockSlug,\r\n    name: \"Test Organic Farm\",\r\n    description: \"A beautiful organic farm\",\r\n    story: \"Our farming journey\",\r\n    ownerId: mockUserId,\r\n    status: \"ACTIVE\" as FarmStatus,\r\n    isVerified: false,\r\n    address: \"123 Farm Road\",\r\n    city: \"Farmville\",\r\n    state: \"CA\",\r\n    zipCode: \"12345\",\r\n    country: \"USA\",\r\n    latitude: 37.7749,\r\n    longitude: -122.4194,\r\n    phone: \"555-0100\",\r\n    email: \"contact@farm.com\",\r\n    website: \"https://farm.com\",\r\n    farmingPractices: [\"ORGANIC\", \"SUSTAINABLE\"] as FarmingPractice[],\r\n    productCategories: [\"VEGETABLES\", \"FRUITS\"] as ProductCategory[],\r\n    totalArea: 50.5,\r\n    totalAreaUnit: \"ACRES\" as const,\r\n    certifications: [\"USDA Organic\"],\r\n    establishedYear: 2010,\r\n    deliveryRadius: 25,\r\n    deliveryRadiusUnit: \"MILES\" as const,\r\n    minimumOrder: 25,\r\n    acceptsOnlineOrders: true,\r\n    allowsPickup: true,\r\n    allowsDelivery: true,\r\n    operatingHours: { monday: \"9am-5pm\" },\r\n    socialMedia: { facebook: \"testfarm\" },\r\n    teamMembers: [\"John\", \"Jane\"],\r\n    coverImage: \"cover.jpg\",\r\n    logoImage: \"logo.jpg\",\r\n    images: [\"img1.jpg\", \"img2.jpg\"],\r\n    createdAt: new Date(\"2024-01-01\"),\r\n    updatedAt: new Date(\"2024-01-01\"),\r\n  };\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    // Reset mock implementations\r\n    jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(null);\r\n    jest.mocked(AgriculturalCache.cacheFarm).mockResolvedValue(undefined);\r\n    jest.mocked(AgriculturalCache.invalidateFarm).mockResolvedValue(undefined);\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.restoreAllMocks();\r\n  });\r\n\r\n  describe(\"createFarmService\", () => {\r\n    const createInput = {\r\n      name: \"New Test Farm\",\r\n      description: \"A new test farm\",\r\n      address: \"456 Farm Lane\",\r\n      city: \"Testville\",\r\n      state: \"NY\",\r\n      zipCode: \"54321\",\r\n      country: \"USA\",\r\n      farmingPractices: [\"ORGANIC\"] as FarmingPractice[],\r\n      productCategories: [\"VEGETABLES\"] as ProductCategory[],\r\n    };\r\n\r\n    it(\"should create a farm successfully\", async () => {\r\n      jest.mocked(database.farm.create).mockResolvedValue(mockFarm as any);\r\n\r\n      const result = await createFarmService({\r\n        userId: mockUserId,\r\n        farmData: createInput as any,\r\n      });\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result.farm.identity.name).toBe(mockFarm.name);\r\n      expect(result.slug).toBeDefined();\r\n      expect(database.farm.create).toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should throw error if user not found\", async () => {\r\n      // Note: The service doesn't validate user existence - it relies on DB foreign key constraint\r\n      // This test documents that behavior\r\n      jest\r\n        .mocked(database.farm.create)\r\n        .mockRejectedValue(new Error(\"Foreign key constraint failed\"));\r\n\r\n      await expect(\r\n        createFarmService({\r\n          userId: \"invalid-user\",\r\n          farmData: createInput as any,\r\n        })\r\n      ).rejects.toThrow();\r\n    });\r\n\r\n    it(\"should generate unique slug from farm name\", async () => {\r\n      jest.mocked(database.user.findUnique).mockResolvedValue(mockUser as any);\r\n      jest.mocked(database.farm.create).mockResolvedValue(mockFarm as any);\r\n\r\n      await createFarmService({\r\n        userId: mockUserId,\r\n        farmData: createInput as any,\r\n      });\r\n\r\n      const createCall = jest.mocked(database.farm.create).mock.calls[0][0];\r\n      expect(createCall.data.slug).toBeDefined();\r\n      expect(typeof createCall.data.slug).toBe(\"string\");\r\n    });\r\n  });\r\n\r\n  describe(\"getFarmById\", () => {\r\n    it(\"should return farm from cache if available\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(mockFarm);\r\n\r\n      const result = await getFarmById(mockFarmId);\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result?.id).toBe(mockFarmId);\r\n      expect(jest.mocked(AgriculturalCache.getFarm)).toHaveBeenCalledWith(\r\n        mockFarmId\r\n      );\r\n      expect(database.farm.findUnique).not.toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should fetch from database if not in cache\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(null);\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n\r\n      const result = await getFarmById(mockFarmId);\r\n\r\n      expect(result).toBeDefined();\r\n      expect(database.farm.findUnique).toHaveBeenCalledWith({\r\n        where: { id: mockFarmId },\r\n        include: expect.any(Object),\r\n      });\r\n      expect(jest.mocked(AgriculturalCache.cacheFarm)).toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should return null for non-existent farm\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(null);\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(null);\r\n\r\n      const result = await getFarmById(\"non-existent-id\");\r\n\r\n      expect(result).toBeNull();\r\n    });\r\n  });\r\n\r\n  describe(\"getFarmBySlug\", () => {\r\n    it(\"should return farm by slug from cache\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(mockFarm);\r\n\r\n      const result = await getFarmBySlug(mockSlug);\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result?.slug).toBe(mockSlug);\r\n      expect(jest.mocked(AgriculturalCache.getFarm)).toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should fetch from database by slug if not cached\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(null);\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n\r\n      const result = await getFarmBySlug(mockSlug);\r\n\r\n      expect(result).toBeDefined();\r\n      expect(database.farm.findUnique).toHaveBeenCalledWith({\r\n        where: { slug: mockSlug },\r\n        include: expect.any(Object),\r\n      });\r\n      expect(jest.mocked(AgriculturalCache.cacheFarm)).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe(\"updateFarmService\", () => {\r\n    const updateData = {\r\n      name: \"Updated Farm Name\",\r\n      description: \"Updated description\",\r\n      phone: \"555-0200\",\r\n    };\r\n\r\n    it(\"should update farm with valid ownership\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue({\r\n        ...mockFarm,\r\n        ...updateData,\r\n      } as any);\r\n\r\n      const result = await updateFarmService({\r\n        farmId: mockFarmId,\r\n        userId: mockUserId,\r\n        updateData,\r\n      });\r\n\r\n      expect(result).toBeDefined();\r\n      expect(result.identity.name).toBe(updateData.name);\r\n      expect(database.farm.update).toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should throw error if farm not found\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(null);\r\n\r\n      await expect(\r\n        updateFarmService({\r\n          farmId: \"non-existent\",\r\n          userId: mockUserId,\r\n          updateData,\r\n        })\r\n      ).rejects.toThrow(\"Farm not found\");\r\n    });\r\n\r\n    it(\"should throw error if user is not owner\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n\r\n      await expect(\r\n        updateFarmService({\r\n          farmId: mockFarmId,\r\n          userId: \"different-user-id\",\r\n          updateData,\r\n        })\r\n      ).rejects.toThrow(\"Unauthorized: You don't own this farm\");\r\n    });\r\n\r\n    it(\"should handle partial updates\", async () => {\r\n      const partialUpdate = { phone: \"555-0300\" };\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue({\r\n        ...mockFarm,\r\n        ...partialUpdate,\r\n      } as any);\r\n\r\n      const result = await updateFarmService({\r\n        farmId: mockFarmId,\r\n        userId: mockUserId,\r\n        updateData: partialUpdate,\r\n      });\r\n\r\n      expect(result.contact.phone).toBe(partialUpdate.phone);\r\n    });\r\n\r\n    it(\"should invalidate cache after update\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue({\r\n        ...mockFarm,\r\n        ...updateData,\r\n      } as any);\r\n\r\n      await updateFarmService({\r\n        farmId: mockFarmId,\r\n        userId: mockUserId,\r\n        updateData,\r\n      });\r\n\r\n      expect(\r\n        jest.mocked(AgriculturalCache.invalidateFarm)\r\n      ).toHaveBeenCalledWith(mockFarmId);\r\n    });\r\n  });\r\n\r\n  describe(\"deleteFarmService\", () => {\r\n    it(\"should soft delete farm (set status to INACTIVE)\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue({\r\n        ownerId: mockUserId,\r\n      } as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue({\r\n        ...mockFarm,\r\n        status: \"INACTIVE\" as FarmStatus,\r\n      } as any);\r\n\r\n      await deleteFarmService({ farmId: mockFarmId, userId: mockUserId });\r\n\r\n      expect(database.farm.update).toHaveBeenCalledWith({\r\n        where: { id: mockFarmId },\r\n        data: { status: \"INACTIVE\" },\r\n      });\r\n    });\r\n\r\n    it(\"should throw error if farm not found\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(null);\r\n\r\n      await expect(\r\n        deleteFarmService({ farmId: \"non-existent\", userId: mockUserId })\r\n      ).rejects.toThrow(\"Farm not found\");\r\n    });\r\n\r\n    it(\"should throw error if user is not owner\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n\r\n      await expect(\r\n        deleteFarmService({ farmId: mockFarmId, userId: \"different-user-id\" })\r\n      ).rejects.toThrow(\"Unauthorized: You don't own this farm\");\r\n    });\r\n\r\n    it(\"should invalidate cache after deletion\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue({\r\n        ...mockFarm,\r\n        status: \"INACTIVE\" as FarmStatus,\r\n      } as any);\r\n\r\n      await deleteFarmService({ farmId: mockFarmId, userId: mockUserId });\r\n\r\n      expect(\r\n        jest.mocked(AgriculturalCache.invalidateFarm)\r\n      ).toHaveBeenCalledWith(mockFarmId);\r\n    });\r\n  });\r\n\r\n  describe(\"listFarmsService\", () => {\r\n    const mockFarms = [mockFarm, { ...mockFarm, id: \"farm-789\" }];\r\n\r\n    it(\"should return paginated farms with default options\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n      jest.mocked(database.farm.count).mockResolvedValue(2);\r\n\r\n      const result = await listFarmsService({});\r\n\r\n      expect(result.farms).toHaveLength(2);\r\n      expect(result.total).toBe(2);\r\n      expect(result.page).toBe(1);\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n    });\r\n\r\n    it(\"should filter by status\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([mockFarm] as any);\r\n      jest.mocked(database.farm.count).mockResolvedValue(1);\r\n\r\n      const result = await listFarmsService({ status: \"ACTIVE\" });\r\n\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n      expect(result.farms).toHaveLength(1);\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where.status).toBe(\"ACTIVE\");\r\n    });\r\n\r\n    it(\"should filter by state\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([mockFarm] as any);\r\n      jest.mocked(database.farm.count).mockResolvedValue(1);\r\n\r\n      const result = await listFarmsService({ state: \"CA\" });\r\n\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n      expect(result.farms).toHaveLength(1);\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where.state).toBe(\"CA\");\r\n    });\r\n\r\n    it(\"should handle pagination correctly\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n      jest.mocked(database.farm.count).mockResolvedValue(20);\r\n\r\n      const result = await listFarmsService({ page: 2, limit: 10 });\r\n\r\n      expect(result.page).toBe(2);\r\n      expect(result.total).toBe(20);\r\n      expect(result.totalPages).toBe(2);\r\n      expect(result.farms).toBeDefined();\r\n      expect(database.farm.findMany).toHaveBeenCalledWith(\r\n        expect.objectContaining({\r\n          take: 10,\r\n          skip: 10, // page 2, skip first 10\r\n        })\r\n      );\r\n    });\r\n\r\n    it(\"should filter by farming practices\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([mockFarm] as any);\r\n      jest.mocked(database.farm.count).mockResolvedValue(1);\r\n\r\n      const result = await listFarmsService({ farmingPractices: [\"ORGANIC\"] });\r\n\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n      expect(result.farms).toHaveLength(1);\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where.farmingPractices).toEqual({ hasSome: [\"ORGANIC\"] });\r\n    });\r\n  });\r\n\r\n  describe(\"searchFarmsService\", () => {\r\n    const mockFarms = [mockFarm];\r\n\r\n    it(\"should search farms by text query\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n\r\n      const result = await searchFarmsService({ query: \"organic\" });\r\n\r\n      expect(result).toHaveLength(1);\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where?.status).toBe(\"ACTIVE\");\r\n      expect(call.where?.OR).toBeDefined();\r\n    });\r\n\r\n    it(\"should search with case-insensitive matching\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n\r\n      const result = await searchFarmsService({ query: \"ORGANIC\" });\r\n\r\n      expect(result).toBeDefined();\r\n      expect(database.farm.findMany).toHaveBeenCalled();\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where?.OR[0]?.name?.mode).toBe(\"insensitive\");\r\n    });\r\n\r\n    it(\"should search across multiple fields\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n\r\n      await searchFarmsService({ query: \"farm\" });\r\n\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.where?.OR).toBeDefined();\r\n      expect(Array.isArray(call.where?.OR)).toBe(true);\r\n      expect((call.where?.OR as any[]).length).toBeGreaterThan(2); // name, description, city, state, etc.\r\n    });\r\n\r\n    it(\"should limit results to 10 by default\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue(mockFarms as any);\r\n\r\n      await searchFarmsService({ query: \"test\" });\r\n\r\n      const call = jest.mocked(database.farm.findMany).mock.calls[0][0];\r\n      expect(call.take).toBe(10);\r\n    });\r\n\r\n    it(\"should return empty array for no matches\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([]);\r\n\r\n      const result = await searchFarmsService({ query: \"nonexistent123\" });\r\n\r\n      expect(result).toEqual([]);\r\n    });\r\n  });\r\n\r\n  describe(\"Edge Cases and Error Handling\", () => {\r\n    it(\"should handle database errors gracefully in getFarmById\", async () => {\r\n      jest.mocked(AgriculturalCache.getFarm).mockResolvedValue(null);\r\n      jest\r\n        .mocked(database.farm.findUnique)\r\n        .mockRejectedValue(new Error(\"Database connection error\"));\r\n\r\n      await expect(getFarmById(mockFarmId)).rejects.toThrow(\r\n        \"Database connection error\"\r\n      );\r\n    });\r\n\r\n    it(\"should handle empty search query\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([mockFarm] as any);\r\n\r\n      const result = await searchFarmsService({ query: \"\" });\r\n\r\n      expect(result).toBeDefined();\r\n      // Should still execute search with empty string\r\n    });\r\n\r\n    it(\"should handle very large pagination requests\", async () => {\r\n      jest.mocked(database.farm.findMany).mockResolvedValue([]);\r\n      jest.mocked(database.farm.count).mockResolvedValue(0);\r\n\r\n      const result = await listFarmsService({ page: 999, limit: 100 });\r\n\r\n      expect(result.farms).toEqual([]);\r\n      expect(result.page).toBe(999);\r\n    });\r\n\r\n    it(\"should handle updates with no changes\", async () => {\r\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\r\n      jest.mocked(database.farm.update).mockResolvedValue(mockFarm as any);\r\n\r\n      const result = await updateFarmService({\r\n        farmId: mockFarmId,\r\n        userId: mockUserId,\r\n        updateData: {},\r\n      });\r\n\r\n      expect(result).toBeDefined();\r\n      // Should still call update even with empty data\r\n    });\r\n  });\r\n});\r\n"],"version":3}