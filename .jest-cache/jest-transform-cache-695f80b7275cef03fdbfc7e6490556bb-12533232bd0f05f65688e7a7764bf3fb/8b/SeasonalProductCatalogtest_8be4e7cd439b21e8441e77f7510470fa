62833257434730ca7007cfc5cec68c11
"use strict";
/**
 * DIVINE TEST SUITE: Seasonal Product Catalog Quantum Reality
 * Tests the manifestation and consciousness of seasonal agricultural products
 */
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const globals_1 = require("@jest/globals");
// Mock the database module
globals_1.jest.mock("@/lib/database", () => ({
    database: {
        product: {
            findMany: globals_1.jest.fn(),
        },
    },
}));
const react_1 = __importDefault(require("react"));
const react_2 = require("@testing-library/react");
const user_event_1 = __importDefault(require("@testing-library/user-event"));
const SeasonalProductCatalog_1 = require("../SeasonalProductCatalog");
(0, globals_1.describe)("SeasonalProductCatalog", () => {
    (0, globals_1.beforeEach)(() => {
        globals_1.jest.clearAllMocks();
    });
    (0, globals_1.describe)("Product Manifestation Reality", () => {
        (0, globals_1.it)("manifests seasonal products with agricultural consciousness", async () => {
            // Arrange
            const mockProducts = [
                {
                    id: "product-1",
                    name: "Organic Spring Tomatoes",
                    season: "SPRING",
                    price: 4.99,
                    inStock: true,
                    farmId: "farm-1",
                },
                {
                    id: "product-2",
                    name: "Divine Summer Zucchini",
                    season: "SUMMER",
                    price: 3.49,
                    inStock: true,
                    farmId: "farm-1",
                },
            ];
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SPRING" }));
            // Assert - Spring products should be visible
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(react_2.screen.getByText(/organic spring tomatoes/i)).toBeInTheDocument();
            });
        });
        (0, globals_1.it)("respects seasonal boundaries and filters appropriately", async () => {
            // Arrange
            const mockProducts = [
                {
                    id: "product-1",
                    name: "Spring Lettuce",
                    season: "SPRING",
                    price: 2.99,
                    inStock: true,
                    farmId: "farm-1",
                },
                {
                    id: "product-2",
                    name: "Fall Pumpkins",
                    season: "FALL",
                    price: 5.99,
                    inStock: true,
                    farmId: "farm-1",
                },
            ];
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SPRING" }));
            // Assert - Only spring products should be visible
            (0, globals_1.expect)(react_2.screen.getByText(/spring lettuce/i)).toBeInTheDocument();
            (0, globals_1.expect)(react_2.screen.queryByText(/fall pumpkins/i)).not.toBeInTheDocument();
        });
        (0, globals_1.it)("handles empty product catalog with divine grace", async () => {
            // Arrange - Empty product array
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: [], season: "SPRING" }));
            // Assert - Should show empty state message
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(react_2.screen.getByText(/no seasonal products/i)).toBeInTheDocument();
            });
        });
    });
    (0, globals_1.describe)("Product Interaction Quantum Mechanics", () => {
        const mockProducts = [
            {
                id: "product-1",
                name: "Quantum Carrots",
                season: "SPRING",
                price: 3.99,
                description: "Biodynamic carrots with consciousness",
                inStock: true,
                farmId: "farm-1",
            },
        ];
        (0, globals_1.it)("allows users to view product details", async () => {
            // Arrange
            const user = user_event_1.default.setup();
            const mockOnProductClick = globals_1.jest.fn();
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SPRING", onProductClick: mockOnProductClick }));
            const productCard = react_2.screen.getByText(/quantum carrots/i);
            await user.click(productCard);
            // Assert
            (0, globals_1.expect)(mockOnProductClick).toHaveBeenCalledWith(mockProducts[0]);
        });
        (0, globals_1.it)("supports adding products to cart with agricultural intent", async () => {
            // Arrange
            const user = user_event_1.default.setup();
            const mockProducts = [
                {
                    id: "product-1",
                    name: "Divine Tomatoes",
                    season: "SUMMER",
                    price: 4.99,
                    inStock: true,
                    farmId: "farm-1",
                },
            ];
            const mockOnAddToCart = globals_1.jest.fn();
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SUMMER", onAddToCart: mockOnAddToCart }));
            const addButton = react_2.screen.getByRole("button", { name: /add to cart/i });
            await user.click(addButton);
            // Assert
            (0, globals_1.expect)(mockOnAddToCart).toHaveBeenCalledWith(mockProducts[0]);
        });
    });
    (0, globals_1.describe)("Agricultural Consciousness Preservation", () => {
        (0, globals_1.it)("maintains biodynamic awareness during rendering", async () => {
            // Arrange
            const mockProducts = [
                {
                    id: "product-1",
                    name: "Biodynamic Spinach",
                    season: "SPRING",
                    price: 3.49,
                    organic: true,
                    biodynamic: true,
                    inStock: true,
                    farmId: "farm-1",
                },
            ];
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SPRING" }));
            // Assert - Biodynamic badge should be visible
            await (0, react_2.waitFor)(() => {
                const badges = react_2.screen.getAllByText(/biodynamic/i);
                (0, globals_1.expect)(badges.length).toBeGreaterThanOrEqual(1);
                (0, globals_1.expect)(react_2.screen.getByText(/organic/i)).toBeInTheDocument();
            });
        });
        (0, globals_1.it)("displays seasonal consciousness indicators", async () => {
            // Arrange
            const mockProducts = [
                {
                    id: "product-1",
                    name: "Seasonal Kale",
                    season: "SPRING",
                    price: 2.99,
                    harvestDate: new Date("2024-04-15"),
                    inStock: true,
                    farmId: "farm-1",
                },
            ];
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: mockProducts, season: "SPRING" }));
            // Assert - Harvest date should be displayed
            await (0, react_2.waitFor)(() => {
                (0, globals_1.expect)(react_2.screen.getByText(/harvested/i)).toBeInTheDocument();
            });
        });
    });
    (0, globals_1.describe)("Performance Quantum Optimization", () => {
        (0, globals_1.it)("efficiently renders large product catalogs", async () => {
            // Arrange
            const largeProductList = Array.from({ length: 100 }, (_, i) => ({
                id: `product-${i}`,
                name: `Product ${i}`,
                season: "SPRING",
                price: 2.99 + i * 0.1,
                inStock: true,
                farmId: "farm-1",
            }));
            const startTime = performance.now();
            // Act
            (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: largeProductList, season: "SPRING" }));
            const renderTime = performance.now() - startTime;
            // Assert - Should render efficiently (< 500ms for 100 items)
            (0, globals_1.expect)(renderTime).toBeLessThan(500);
        });
        (0, globals_1.it)("implements virtualization for optimal performance", async () => {
            // Arrange
            const manyProducts = Array.from({ length: 500 }, (_, i) => ({
                id: `product-${i}`,
                name: `Product ${i}`,
                season: "SPRING",
                price: 2.99,
                inStock: true,
                farmId: "farm-1",
            }));
            // Act
            const { container } = (0, react_2.render)(react_1.default.createElement(SeasonalProductCatalog_1.SeasonalProductCatalog, { products: manyProducts, season: "SPRING", virtualized: true }));
            // Assert - Should only render visible items initially
            const renderedItems = container.querySelectorAll('[data-testid^="product-"]');
            (0, globals_1.expect)(renderedItems.length).toBeLessThan(50); // Should virtualize
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiTTpcXFJlcG9cXEZhcm1lcnMgTWFya2V0IFBsYXRmb3JtIHdlYiBhbmQgYXBwXFxzcmNcXGNvbXBvbmVudHNcXF9fdGVzdHNfX1xcU2Vhc29uYWxQcm9kdWN0Q2F0YWxvZy50ZXN0LnRzeCIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7OztBQUdILDJDQUF1RTtBQUt2RSwyQkFBMkI7QUFDM0IsY0FBSSxDQUFDLElBQUksQ0FBQyxnQkFBZ0IsRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO0lBQ2pDLFFBQVEsRUFBRTtRQUNSLE9BQU8sRUFBRTtZQUNQLFFBQVEsRUFBRSxjQUFJLENBQUMsRUFBRSxFQUE4QjtTQUNoRDtLQUNGO0NBQ0YsQ0FBQyxDQUFDLENBQUM7QUFiSixrREFBMEI7QUFFMUIsa0RBQWlFO0FBQ2pFLDZFQUFvRDtBQUNwRCxzRUFBbUU7QUFXbkUsSUFBQSxrQkFBUSxFQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUN0QyxJQUFBLG9CQUFVLEVBQUMsR0FBRyxFQUFFO1FBQ2QsY0FBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO0lBQ3ZCLENBQUMsQ0FBQyxDQUFDO0lBRUgsSUFBQSxrQkFBUSxFQUFDLCtCQUErQixFQUFFLEdBQUcsRUFBRTtRQUM3QyxJQUFBLFlBQUUsRUFBQyw2REFBNkQsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMzRSxVQUFVO1lBQ1YsTUFBTSxZQUFZLEdBQUc7Z0JBQ25CO29CQUNFLEVBQUUsRUFBRSxXQUFXO29CQUNmLElBQUksRUFBRSx5QkFBeUI7b0JBQy9CLE1BQU0sRUFBRSxRQUFRO29CQUNoQixLQUFLLEVBQUUsSUFBSTtvQkFDWCxPQUFPLEVBQUUsSUFBSTtvQkFDYixNQUFNLEVBQUUsUUFBUTtpQkFDakI7Z0JBQ0Q7b0JBQ0UsRUFBRSxFQUFFLFdBQVc7b0JBQ2YsSUFBSSxFQUFFLHdCQUF3QjtvQkFDOUIsTUFBTSxFQUFFLFFBQVE7b0JBQ2hCLEtBQUssRUFBRSxJQUFJO29CQUNYLE9BQU8sRUFBRSxJQUFJO29CQUNiLE1BQU0sRUFB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QyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiTTpcXFJlcG9cXEZhcm1lcnMgTWFya2V0IFBsYXRmb3JtIHdlYiBhbmQgYXBwXFxzcmNcXGNvbXBvbmVudHNcXF9fdGVzdHNfX1xcU2Vhc29uYWxQcm9kdWN0Q2F0YWxvZy50ZXN0LnRzeCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERJVklORSBURVNUIFNVSVRFOiBTZWFzb25hbCBQcm9kdWN0IENhdGFsb2cgUXVhbnR1bSBSZWFsaXR5XG4gKiBUZXN0cyB0aGUgbWFuaWZlc3RhdGlvbiBhbmQgY29uc2Npb3VzbmVzcyBvZiBzZWFzb25hbCBhZ3JpY3VsdHVyYWwgcHJvZHVjdHNcbiAqL1xuXG5pbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnO1xuaW1wb3J0IHsgYmVmb3JlRWFjaCwgZGVzY3JpYmUsIGV4cGVjdCwgaXQsIGplc3QgfSBmcm9tIFwiQGplc3QvZ2xvYmFsc1wiO1xuaW1wb3J0IHsgcmVuZGVyLCBzY3JlZW4sIHdhaXRGb3IgfSBmcm9tICdAdGVzdGluZy1saWJyYXJ5L3JlYWN0JztcbmltcG9ydCB1c2VyRXZlbnQgZnJvbSAnQHRlc3RpbmctbGlicmFyeS91c2VyLWV2ZW50JztcbmltcG9ydCB7IFNlYXNvbmFsUHJvZHVjdENhdGFsb2cgfSBmcm9tICcuLi9TZWFzb25hbFByb2R1Y3RDYXRhbG9nJztcblxuLy8gTW9jayB0aGUgZGF0YWJhc2UgbW9kdWxlXG5qZXN0Lm1vY2soXCJAL2xpYi9kYXRhYmFzZVwiLCAoKSA9PiAoe1xuICBkYXRhYmFzZToge1xuICAgIHByb2R1Y3Q6IHtcbiAgICAgIGZpbmRNYW55OiBqZXN0LmZuKCkgYXMgamVzdC5Nb2NrZWRGdW5jdGlvbjxhbnk+LFxuICAgIH0sXG4gIH0sXG59KSk7XG5cbmRlc2NyaWJlKFwiU2Vhc29uYWxQcm9kdWN0Q2F0YWxvZ1wiLCAoKSA9PiB7XG4gIGJlZm9yZUVhY2goKCkgPT4ge1xuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xuICB9KTtcblxuICBkZXNjcmliZShcIlByb2R1Y3QgTWFuaWZlc3RhdGlvbiBSZWFsaXR5XCIsICgpID0+IHtcbiAgICBpdChcIm1hbmlmZXN0cyBzZWFzb25hbCBwcm9kdWN0cyB3aXRoIGFncmljdWx0dXJhbCBjb25zY2lvdXNuZXNzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBcInByb2R1Y3QtMVwiLFxuICAgICAgICAgIG5hbWU6IFwiT3JnYW5pYyBTcHJpbmcgVG9tYXRvZXNcIixcbiAgICAgICAgICBzZWFzb246IFwiU1BSSU5HXCIsXG4gICAgICAgICAgcHJpY2U6IDQuOTksXG4gICAgICAgICAgaW5TdG9jazogdHJ1ZSxcbiAgICAgICAgICBmYXJtSWQ6IFwiZmFybS0xXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogXCJwcm9kdWN0LTJcIixcbiAgICAgICAgICBuYW1lOiBcIkRpdmluZSBTdW1tZXIgWnVjY2hpbmlcIixcbiAgICAgICAgICBzZWFzb246IFwiU1VNTUVSXCIsXG4gICAgICAgICAgcHJpY2U6IDMuNDksXG4gICAgICAgICAgaW5TdG9jazogdHJ1ZSxcbiAgICAgICAgICBmYXJtSWQ6IFwiZmFybS0xXCIsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlYXNvbmFsUHJvZHVjdENhdGFsb2cgcHJvZHVjdHM9e21vY2tQcm9kdWN0c30gc2Vhc29uPVwiU1BSSU5HXCIgLz5cbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydCAtIFNwcmluZyBwcm9kdWN0cyBzaG91bGQgYmUgdmlzaWJsZVxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChcbiAgICAgICAgICBzY3JlZW4uZ2V0QnlUZXh0KC9vcmdhbmljIHNwcmluZyB0b21hdG9lcy9pKVxuICAgICAgICApLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KFwicmVzcGVjdHMgc2Vhc29uYWwgYm91bmRhcmllcyBhbmQgZmlsdGVycyBhcHByb3ByaWF0ZWx5XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBcInByb2R1Y3QtMVwiLFxuICAgICAgICAgIG5hbWU6IFwiU3ByaW5nIExldHR1Y2VcIixcbiAgICAgICAgICBzZWFzb246IFwiU1BSSU5HXCIsXG4gICAgICAgICAgcHJpY2U6IDIuOTksXG4gICAgICAgICAgaW5TdG9jazogdHJ1ZSxcbiAgICAgICAgICBmYXJtSWQ6IFwiZmFybS0xXCIsXG4gICAgICAgIH0sXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogXCJwcm9kdWN0LTJcIixcbiAgICAgICAgICBuYW1lOiBcIkZhbGwgUHVtcGtpbnNcIixcbiAgICAgICAgICBzZWFzb246IFwiRkFMTFwiLFxuICAgICAgICAgIHByaWNlOiA1Ljk5LFxuICAgICAgICAgIGluU3RvY2s6IHRydWUsXG4gICAgICAgICAgZmFybUlkOiBcImZhcm0tMVwiLFxuICAgICAgICB9LFxuICAgICAgXTtcblxuICAgICAgLy8gQWN0XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxTZWFzb25hbFByb2R1Y3RDYXRhbG9nIHByb2R1Y3RzPXttb2NrUHJvZHVjdHN9IHNlYXNvbj1cIlNQUklOR1wiIC8+XG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnQgLSBPbmx5IHNwcmluZyBwcm9kdWN0cyBzaG91bGQgYmUgdmlzaWJsZVxuICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL3NwcmluZyBsZXR0dWNlL2kpKS50b0JlSW5UaGVEb2N1bWVudCgpO1xuICAgICAgZXhwZWN0KHNjcmVlbi5xdWVyeUJ5VGV4dCgvZmFsbCBwdW1wa2lucy9pKSkubm90LnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgfSk7XG5cbiAgICBpdChcImhhbmRsZXMgZW1wdHkgcHJvZHVjdCBjYXRhbG9nIHdpdGggZGl2aW5lIGdyYWNlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2UgLSBFbXB0eSBwcm9kdWN0IGFycmF5XG4gICAgICByZW5kZXIoPFNlYXNvbmFsUHJvZHVjdENhdGFsb2cgcHJvZHVjdHM9e1tdfSBzZWFzb249XCJTUFJJTkdcIiAvPik7XG5cbiAgICAgIC8vIEFzc2VydCAtIFNob3VsZCBzaG93IGVtcHR5IHN0YXRlIG1lc3NhZ2VcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBleHBlY3Qoc2NyZWVuLmdldEJ5VGV4dCgvbm8gc2Vhc29uYWwgcHJvZHVjdHMvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJQcm9kdWN0IEludGVyYWN0aW9uIFF1YW50dW0gTWVjaGFuaWNzXCIsICgpID0+IHtcbiAgICBjb25zdCBtb2NrUHJvZHVjdHMgPSBbXG4gICAgICB7XG4gICAgICAgIGlkOiBcInByb2R1Y3QtMVwiLFxuICAgICAgICBuYW1lOiBcIlF1YW50dW0gQ2Fycm90c1wiLFxuICAgICAgICBzZWFzb246IFwiU1BSSU5HXCIgYXMgY29uc3QsXG4gICAgICAgIHByaWNlOiAzLjk5LFxuICAgICAgICBkZXNjcmlwdGlvbjogXCJCaW9keW5hbWljIGNhcnJvdHMgd2l0aCBjb25zY2lvdXNuZXNzXCIsXG4gICAgICAgIGluU3RvY2s6IHRydWUsXG4gICAgICAgIGZhcm1JZDogXCJmYXJtLTFcIixcbiAgICAgIH0sXG4gICAgXTtcblxuICAgIGl0KFwiYWxsb3dzIHVzZXJzIHRvIHZpZXcgcHJvZHVjdCBkZXRhaWxzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVzZXIgPSB1c2VyRXZlbnQuc2V0dXAoKTtcblxuICAgICAgY29uc3QgbW9ja09uUHJvZHVjdENsaWNrID0gamVzdC5mbigpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlYXNvbmFsUHJvZHVjdENhdGFsb2dcbiAgICAgICAgICBwcm9kdWN0cz17bW9ja1Byb2R1Y3RzfVxuICAgICAgICAgIHNlYXNvbj1cIlNQUklOR1wiXG4gICAgICAgICAgb25Qcm9kdWN0Q2xpY2s9e21vY2tPblByb2R1Y3RDbGlja31cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHByb2R1Y3RDYXJkID0gc2NyZWVuLmdldEJ5VGV4dCgvcXVhbnR1bSBjYXJyb3RzL2kpO1xuICAgICAgYXdhaXQgdXNlci5jbGljayhwcm9kdWN0Q2FyZCk7XG5cbiAgICAgIC8vIEFzc2VydFxuICAgICAgZXhwZWN0KG1vY2tPblByb2R1Y3RDbGljaykudG9IYXZlQmVlbkNhbGxlZFdpdGgobW9ja1Byb2R1Y3RzWzBdKTtcbiAgICB9KTtcblxuICAgIGl0KFwic3VwcG9ydHMgYWRkaW5nIHByb2R1Y3RzIHRvIGNhcnQgd2l0aCBhZ3JpY3VsdHVyYWwgaW50ZW50XCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IHVzZXIgPSB1c2VyRXZlbnQuc2V0dXAoKTtcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBcInByb2R1Y3QtMVwiLFxuICAgICAgICAgIG5hbWU6IFwiRGl2aW5lIFRvbWF0b2VzXCIsXG4gICAgICAgICAgc2Vhc29uOiBcIlNVTU1FUlwiLFxuICAgICAgICAgIHByaWNlOiA0Ljk5LFxuICAgICAgICAgIGluU3RvY2s6IHRydWUsXG4gICAgICAgICAgZmFybUlkOiBcImZhcm0tMVwiLFxuICAgICAgICB9LFxuICAgICAgXTtcblxuICAgICAgY29uc3QgbW9ja09uQWRkVG9DYXJ0ID0gamVzdC5mbigpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlYXNvbmFsUHJvZHVjdENhdGFsb2dcbiAgICAgICAgICBwcm9kdWN0cz17bW9ja1Byb2R1Y3RzfVxuICAgICAgICAgIHNlYXNvbj1cIlNVTU1FUlwiXG4gICAgICAgICAgb25BZGRUb0NhcnQ9e21vY2tPbkFkZFRvQ2FydH1cbiAgICAgICAgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IGFkZEJ1dHRvbiA9IHNjcmVlbi5nZXRCeVJvbGUoXCJidXR0b25cIiwgeyBuYW1lOiAvYWRkIHRvIGNhcnQvaSB9KTtcbiAgICAgIGF3YWl0IHVzZXIuY2xpY2soYWRkQnV0dG9uKTtcblxuICAgICAgLy8gQXNzZXJ0XG4gICAgICBleHBlY3QobW9ja09uQWRkVG9DYXJ0KS50b0hhdmVCZWVuQ2FsbGVkV2l0aChtb2NrUHJvZHVjdHNbMF0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkFncmljdWx0dXJhbCBDb25zY2lvdXNuZXNzIFByZXNlcnZhdGlvblwiLCAoKSA9PiB7XG4gICAgaXQoXCJtYWludGFpbnMgYmlvZHluYW1pYyBhd2FyZW5lc3MgZHVyaW5nIHJlbmRlcmluZ1wiLCBhc3luYyAoKSA9PiB7XG4gICAgICAvLyBBcnJhbmdlXG4gICAgICBjb25zdCBtb2NrUHJvZHVjdHMgPSBbXG4gICAgICAgIHtcbiAgICAgICAgICBpZDogXCJwcm9kdWN0LTFcIixcbiAgICAgICAgICBuYW1lOiBcIkJpb2R5bmFtaWMgU3BpbmFjaFwiLFxuICAgICAgICAgIHNlYXNvbjogXCJTUFJJTkdcIixcbiAgICAgICAgICBwcmljZTogMy40OSxcbiAgICAgICAgICBvcmdhbmljOiB0cnVlLFxuICAgICAgICAgIGJpb2R5bmFtaWM6IHRydWUsXG4gICAgICAgICAgaW5TdG9jazogdHJ1ZSxcbiAgICAgICAgICBmYXJtSWQ6IFwiZmFybS0xXCIsXG4gICAgICAgIH0sXG4gICAgICBdO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIHJlbmRlcihcbiAgICAgICAgPFNlYXNvbmFsUHJvZHVjdENhdGFsb2cgcHJvZHVjdHM9e21vY2tQcm9kdWN0c30gc2Vhc29uPVwiU1BSSU5HXCIgLz5cbiAgICAgICk7XG5cbiAgICAgIC8vIEFzc2VydCAtIEJpb2R5bmFtaWMgYmFkZ2Ugc2hvdWxkIGJlIHZpc2libGVcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xuICAgICAgICBjb25zdCBiYWRnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KC9iaW9keW5hbWljL2kpO1xuICAgICAgICBleHBlY3QoYmFkZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuT3JFcXVhbCgxKTtcbiAgICAgICAgZXhwZWN0KHNjcmVlbi5nZXRCeVRleHQoL29yZ2FuaWMvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIGl0KFwiZGlzcGxheXMgc2Vhc29uYWwgY29uc2Npb3VzbmVzcyBpbmRpY2F0b3JzXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1vY2tQcm9kdWN0cyA9IFtcbiAgICAgICAge1xuICAgICAgICAgIGlkOiBcInByb2R1Y3QtMVwiLFxuICAgICAgICAgIG5hbWU6IFwiU2Vhc29uYWwgS2FsZVwiLFxuICAgICAgICAgIHNlYXNvbjogXCJTUFJJTkdcIixcbiAgICAgICAgICBwcmljZTogMi45OSxcbiAgICAgICAgICBoYXJ2ZXN0RGF0ZTogbmV3IERhdGUoXCIyMDI0LTA0LTE1XCIpLFxuICAgICAgICAgIGluU3RvY2s6IHRydWUsXG4gICAgICAgICAgZmFybUlkOiBcImZhcm0tMVwiLFxuICAgICAgICB9LFxuICAgICAgXTtcblxuICAgICAgLy8gQWN0XG4gICAgICByZW5kZXIoXG4gICAgICAgIDxTZWFzb25hbFByb2R1Y3RDYXRhbG9nIHByb2R1Y3RzPXttb2NrUHJvZHVjdHN9IHNlYXNvbj1cIlNQUklOR1wiIC8+XG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnQgLSBIYXJ2ZXN0IGRhdGUgc2hvdWxkIGJlIGRpc3BsYXllZFxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XG4gICAgICAgIGV4cGVjdChzY3JlZW4uZ2V0QnlUZXh0KC9oYXJ2ZXN0ZWQvaSkpLnRvQmVJblRoZURvY3VtZW50KCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJQZXJmb3JtYW5jZSBRdWFudHVtIE9wdGltaXphdGlvblwiLCAoKSA9PiB7XG4gICAgaXQoXCJlZmZpY2llbnRseSByZW5kZXJzIGxhcmdlIHByb2R1Y3QgY2F0YWxvZ3NcIiwgYXN5bmMgKCkgPT4ge1xuICAgICAgLy8gQXJyYW5nZVxuICAgICAgY29uc3QgbGFyZ2VQcm9kdWN0TGlzdCA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDEwMCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBwcm9kdWN0LSR7aX1gLFxuICAgICAgICBuYW1lOiBgUHJvZHVjdCAke2l9YCxcbiAgICAgICAgc2Vhc29uOiBcIlNQUklOR1wiLFxuICAgICAgICBwcmljZTogMi45OSArIGkgKiAwLjEsXG4gICAgICAgIGluU3RvY2s6IHRydWUsXG4gICAgICAgIGZhcm1JZDogXCJmYXJtLTFcIixcbiAgICAgIH0pKTtcblxuICAgICAgY29uc3Qgc3RhcnRUaW1lID0gcGVyZm9ybWFuY2Uubm93KCk7XG5cbiAgICAgIC8vIEFjdFxuICAgICAgcmVuZGVyKFxuICAgICAgICA8U2Vhc29uYWxQcm9kdWN0Q2F0YWxvZyBwcm9kdWN0cz17bGFyZ2VQcm9kdWN0TGlzdH0gc2Vhc29uPVwiU1BSSU5HXCIgLz5cbiAgICAgICk7XG5cbiAgICAgIGNvbnN0IHJlbmRlclRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgLy8gQXNzZXJ0IC0gU2hvdWxkIHJlbmRlciBlZmZpY2llbnRseSAoPCA1MDBtcyBmb3IgMTAwIGl0ZW1zKVxuICAgICAgZXhwZWN0KHJlbmRlclRpbWUpLnRvQmVMZXNzVGhhbig1MDApO1xuICAgIH0pO1xuXG4gICAgaXQoXCJpbXBsZW1lbnRzIHZpcnR1YWxpemF0aW9uIGZvciBvcHRpbWFsIHBlcmZvcm1hbmNlXCIsIGFzeW5jICgpID0+IHtcbiAgICAgIC8vIEFycmFuZ2VcbiAgICAgIGNvbnN0IG1hbnlQcm9kdWN0cyA9IEFycmF5LmZyb20oeyBsZW5ndGg6IDUwMCB9LCAoXywgaSkgPT4gKHtcbiAgICAgICAgaWQ6IGBwcm9kdWN0LSR7aX1gLFxuICAgICAgICBuYW1lOiBgUHJvZHVjdCAke2l9YCxcbiAgICAgICAgc2Vhc29uOiBcIlNQUklOR1wiLFxuICAgICAgICBwcmljZTogMi45OSxcbiAgICAgICAgaW5TdG9jazogdHJ1ZSxcbiAgICAgICAgZmFybUlkOiBcImZhcm0tMVwiLFxuICAgICAgfSkpO1xuXG4gICAgICAvLyBBY3RcbiAgICAgIGNvbnN0IHsgY29udGFpbmVyIH0gPSByZW5kZXIoXG4gICAgICAgIDxTZWFzb25hbFByb2R1Y3RDYXRhbG9nXG4gICAgICAgICAgcHJvZHVjdHM9e21hbnlQcm9kdWN0c31cbiAgICAgICAgICBzZWFzb249XCJTUFJJTkdcIlxuICAgICAgICAgIHZpcnR1YWxpemVkXG4gICAgICAgIC8+XG4gICAgICApO1xuXG4gICAgICAvLyBBc3NlcnQgLSBTaG91bGQgb25seSByZW5kZXIgdmlzaWJsZSBpdGVtcyBpbml0aWFsbHlcbiAgICAgIGNvbnN0IHJlbmRlcmVkSXRlbXMgPSBjb250YWluZXIucXVlcnlTZWxlY3RvckFsbChcbiAgICAgICAgJ1tkYXRhLXRlc3RpZF49XCJwcm9kdWN0LVwiXSdcbiAgICAgICk7XG4gICAgICBleHBlY3QocmVuZGVyZWRJdGVtcy5sZW5ndGgpLnRvQmVMZXNzVGhhbig1MCk7IC8vIFNob3VsZCB2aXJ0dWFsaXplXG4gICAgfSk7XG4gIH0pO1xufSk7XG4iXSwidmVyc2lvbiI6M30=