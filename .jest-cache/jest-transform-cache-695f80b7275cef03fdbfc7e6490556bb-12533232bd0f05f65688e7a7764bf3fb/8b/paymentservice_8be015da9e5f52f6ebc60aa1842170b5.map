{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\payment.service.ts","mappings":";AAAA;;;GAGG;;;AAEH,6CAA0C;AAS1C,MAAa,cAAc;IACzB;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,mBAAmB,CAC9B,OAAe,EACf,MAAc,EACd,QAAQ,GAAG,KAAK;QAEhB,8CAA8C;QAC9C,MAAM,aAAa,GAAG;YACpB,EAAE,EAAE,MAAM,IAAI,CAAC,GAAG,EAAE,EAAE;YACtB,MAAM;YACN,QAAQ;YACR,MAAM,EAAE,SAAS;SAClB,CAAC;QAEF,sCAAsC;QACtC,MAAM,mBAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;YAC1B,KAAK,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE;YACtB,IAAI,EAAE;gBACJ,eAAe,EAAE,aAAa,CAAC,EAAE;gBACjC,aAAa,EAAE,SAAS;aACzB;SACF,CAAC,CAAC;QAEH,OAAO,aAAa,CAAC;IACvB,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,cAAc,CAAC,eAAuB;QACjD,+CAA+C;QAC/C,OAAO,CAAC,GAAG,CAAC,iCAAiC,eAAe,EAAE,CAAC,CAAC;QAEhE,gDAAgD;QAChD,MAAM,mBAAQ,CAAC,KAAK,CAAC,UAAU,CAAC;YAC9B,KAAK,EAAE,EAAE,eAAe,EAAE;YAC1B,IAAI,EAAE;gBACJ,aAAa,EAAE,WAAkB;gBACjC,MAAM,EAAE,WAAW;gBACnB,MAAM,EAAE,IAAI,IAAI,EAAE;aACnB;SACF,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IACd,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,KAAK,CAAC,aAAa,CACxB,OAAe,EACf,OAAgB;QAEhB,MAAM,KAAK,GAAG,MAAM,mBAAQ,CAAC,KAAK,CAAC,UAAU,CAAC;YAC5C,KAAK,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE;SACvB,CAAC,CAAC;QAEH,IAAI,CAAC,KAAK,EAAE,CAAC;YACX,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;QACrC,CAAC;QAED,sDAAsD;QAEtD,MAAM,mBAAQ,CAAC,KAAK,CAAC,MAAM,CAAC;YAC1B,KAAK,EAAE,EAAE,EAAE,EAAE,OAAO,EAAE;YACtB,IAAI,EAAE;gBACJ,aAAa,EAAE,UAAU;gBACzB,MAAM,EAAE,WAAW;aACpB;SACF,CAAC,CAAC;QAEH,OAAO,IAAI,CAAC;IACd,CAAC;CACF;AA5ED,wCA4EC","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\payment.service.ts"],"sourcesContent":["/**\n * ðŸ’³ PAYMENT SERVICE\n * Handles payment processing via Stripe and PayPal\n */\n\nimport { database } from \"@/lib/database\";\n\nexport interface PaymentIntent {\n  id: string;\n  amount: number;\n  currency: string;\n  status: string;\n}\n\nexport class PaymentService {\n  /**\n   * Create payment intent\n   */\n  static async createPaymentIntent(\n    orderId: string,\n    amount: number,\n    currency = \"USD\"\n  ): Promise<PaymentIntent> {\n    // In production, integrate with Stripe/PayPal\n    const paymentIntent = {\n      id: `pi_${Date.now()}`,\n      amount,\n      currency,\n      status: \"pending\",\n    };\n\n    // Store payment intent ID in database\n    await database.order.update({\n      where: { id: orderId },\n      data: {\n        paymentIntentId: paymentIntent.id,\n        paymentStatus: \"PENDING\",\n      },\n    });\n\n    return paymentIntent;\n  }\n\n  /**\n   * Confirm payment\n   */\n  static async confirmPayment(paymentIntentId: string): Promise<boolean> {\n    // In production, confirm with payment provider\n    console.log(`Payment confirmed for intent: ${paymentIntentId}`);\n\n    // Update all orders with this payment intent ID\n    await database.order.updateMany({\n      where: { paymentIntentId },\n      data: {\n        paymentStatus: \"COMPLETED\" as any,\n        status: \"CONFIRMED\",\n        paidAt: new Date(),\n      },\n    });\n\n    return true;\n  }\n\n  /**\n   * Refund a payment\n   */\n  static async refundPayment(\n    orderId: string,\n    _amount?: number\n  ): Promise<boolean> {\n    const order = await database.order.findUnique({\n      where: { id: orderId },\n    });\n\n    if (!order) {\n      throw new Error(\"Order not found\");\n    }\n\n    // In production, process refund with payment provider\n\n    await database.order.update({\n      where: { id: orderId },\n      data: {\n        paymentStatus: \"REFUNDED\",\n        status: \"CANCELLED\",\n      },\n    });\n\n    return true;\n  }\n}\n"],"version":3}