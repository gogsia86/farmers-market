8e181c521a2b39c14149b06297a07651
"use strict";
/**
 * ðŸ”’ SECURITY SERVICE
 * Handles input validation, sanitization, and security checks
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.SecurityService = void 0;
class SecurityService {
    /**
     * Sanitize user input to prevent XSS
     */
    static sanitizeInput(input) {
        return input
            .replace(/</g, "&lt;")
            .replace(/>/g, "&gt;")
            .replace(/"/g, "&quot;")
            .replace(/'/g, "&#x27;")
            .replace(/\//g, "&#x2F;");
    }
    /**
     * Validate email format
     */
    static isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
    }
    /**
     * Validate phone number
     */
    static isValidPhone(phone) {
        const phoneRegex = /^\(?([0-9]{3})\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;
        return phoneRegex.test(phone);
    }
    /**
     * Check password strength
     */
    static isStrongPassword(password) {
        const errors = [];
        if (password.length < 8) {
            errors.push("Password must be at least 8 characters");
        }
        if (!/[A-Z]/.test(password)) {
            errors.push("Password must contain uppercase letter");
        }
        if (!/[a-z]/.test(password)) {
            errors.push("Password must contain lowercase letter");
        }
        if (!/[0-9]/.test(password)) {
            errors.push("Password must contain number");
        }
        if (!/[!@#$%^&*]/.test(password)) {
            errors.push("Password must contain special character");
        }
        return {
            valid: errors.length === 0,
            errors,
        };
    }
    /**
     * Rate limiting check
     */
    static checkRateLimit(_identifier, _maxRequests, _windowMs) {
        // In production, use Redis for distributed rate limiting
        return true; // Placeholder
    }
    /**
     * Validate file upload
     */
    static validateFileUpload(file, options) {
        if (file.size > options.maxSize) {
            return {
                valid: false,
                error: `File too large. Max size: ${options.maxSize / 1024 / 1024}MB`,
            };
        }
        if (!options.allowedTypes.includes(file.type)) {
            return {
                valid: false,
                error: `Invalid file type. Allowed: ${options.allowedTypes.join(", ")}`,
            };
        }
        return { valid: true };
    }
}
exports.SecurityService = SecurityService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiTTpcXFJlcG9cXEZhcm1lcnMgTWFya2V0IFBsYXRmb3JtIHdlYiBhbmQgYXBwXFxzcmNcXGxpYlxcc2VydmljZXNcXHNlY3VyaXR5XFxzZWN1cml0eS5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7OztBQUVILE1BQWEsZUFBZTtJQUMxQjs7T0FFRztJQUNILE1BQU0sQ0FBQyxhQUFhLENBQUMsS0FBYTtRQUNoQyxPQUFPLEtBQUs7YUFDVCxPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQzthQUNyQixPQUFPLENBQUMsSUFBSSxFQUFFLE1BQU0sQ0FBQzthQUNyQixPQUFPLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQzthQUN2QixPQUFPLENBQUMsSUFBSSxFQUFFLFFBQVEsQ0FBQzthQUN2QixPQUFPLENBQUMsS0FBSyxFQUFFLFFBQVEsQ0FBQyxDQUFDO0lBQzlCLENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxZQUFZLENBQUMsS0FBYTtRQUMvQixNQUFNLFVBQVUsR0FBRyw0QkFBNEIsQ0FBQztRQUNoRCxPQUFPLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEMsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLFlBQVksQ0FBQyxLQUFhO1FBQy9CLE1BQU0sVUFBVSxHQUFHLG9EQUFvRCxDQUFDO1FBQ3hFLE9BQU8sVUFBVSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNoQyxDQUFDO0lBRUQ7O09BRUc7SUFDSCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsUUFBZ0I7UUFJdEMsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO1FBRTVCLElBQUksUUFBUSxDQUFDLE1BQU0sR0FBRyxDQUFDLEVBQUUsQ0FBQztZQUN4QixNQUFNLENBQUMsSUFBSSxDQUFDLHdDQUF3QyxDQUFDLENBQUM7UUFDeEQsQ0FBQztRQUNELElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7WUFDNUIsTUFBTSxDQUFDLElBQUksQ0FBQyx3Q0FBd0MsQ0FBQyxDQUFDO1FBQ3hELENBQUM7UUFDRCxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsRUFBRSxDQUFDO1lBQzVCLE1BQU0sQ0FBQyxJQUFJLENBQUMsd0NBQXdDLENBQUMsQ0FBQztRQUN4RCxDQUFDO1FBQ0QsSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQztZQUM1QixNQUFNLENBQUMsSUFBSSxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDOUMsQ0FBQztRQUNELElBQUksQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxFQUFFLENBQUM7WUFDakMsTUFBTSxDQUFDLElBQUksQ0FBQyx5Q0FBeUMsQ0FBQyxDQUFDO1FBQ3pELENBQUM7UUFFRCxPQUFPO1lBQ0wsS0FBSyxFQUFFLE1BQU0sQ0FBQyxNQUFNLEtBQUssQ0FBQztZQUMxQixNQUFNO1NBQ1AsQ0FBQztJQUNKLENBQUM7SUFFRDs7T0FFRztJQUNILE1BQU0sQ0FBQyxjQUFjLENBQ25CLFdBQW1CLEVBQ25CLFlBQW9CLEVBQ3BCLFNBQWlCO1FBRWpCLHlEQUF5RDtRQUN6RCxPQUFPLElBQUksQ0FBQyxDQUFDLGNBQWM7SUFDN0IsQ0FBQztJQUVEOztPQUVHO0lBQ0gsTUFBTSxDQUFDLGtCQUFrQixDQUN2QixJQUFvQyxFQUNwQyxPQUdDO1FBRUQsSUFBSSxJQUFJLENBQUMsSUFBSSxHQUFHLE9BQU8sQ0FBQyxPQUFPLEVBQUUsQ0FBQztZQUNoQyxPQUFPO2dCQUNMLEtBQUssRUFBRSxLQUFLO2dCQUNaLEtBQUssRUFBRSw2QkFBNkIsT0FBTyxDQUFDLE9BQU8sR0FBRyxJQUFJLEdBQUcsSUFBSSxJQUFJO2FBQ3RFLENBQUM7UUFDSixDQUFDO1FBRUQsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDO1lBQzlDLE9BQU87Z0JBQ0wsS0FBSyxFQUFFLEtBQUs7Z0JBQ1osS0FBSyxFQUFFLCtCQUErQixPQUFPLENBQUMsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRTthQUN4RSxDQUFDO1FBQ0osQ0FBQztRQUVELE9BQU8sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUM7SUFDekIsQ0FBQztDQUNGO0FBbEdELDBDQWtHQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJNOlxcUmVwb1xcRmFybWVycyBNYXJrZXQgUGxhdGZvcm0gd2ViIGFuZCBhcHBcXHNyY1xcbGliXFxzZXJ2aWNlc1xcc2VjdXJpdHlcXHNlY3VyaXR5LnNlcnZpY2UudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDwn5SSIFNFQ1VSSVRZIFNFUlZJQ0VcbiAqIEhhbmRsZXMgaW5wdXQgdmFsaWRhdGlvbiwgc2FuaXRpemF0aW9uLCBhbmQgc2VjdXJpdHkgY2hlY2tzXG4gKi9cblxuZXhwb3J0IGNsYXNzIFNlY3VyaXR5U2VydmljZSB7XG4gIC8qKlxuICAgKiBTYW5pdGl6ZSB1c2VyIGlucHV0IHRvIHByZXZlbnQgWFNTXG4gICAqL1xuICBzdGF0aWMgc2FuaXRpemVJbnB1dChpbnB1dDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gaW5wdXRcbiAgICAgIC5yZXBsYWNlKC88L2csIFwiJmx0O1wiKVxuICAgICAgLnJlcGxhY2UoLz4vZywgXCImZ3Q7XCIpXG4gICAgICAucmVwbGFjZSgvXCIvZywgXCImcXVvdDtcIilcbiAgICAgIC5yZXBsYWNlKC8nL2csIFwiJiN4Mjc7XCIpXG4gICAgICAucmVwbGFjZSgvXFwvL2csIFwiJiN4MkY7XCIpO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIGVtYWlsIGZvcm1hdFxuICAgKi9cbiAgc3RhdGljIGlzVmFsaWRFbWFpbChlbWFpbDogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgZW1haWxSZWdleCA9IC9eW15cXHNAXStAW15cXHNAXStcXC5bXlxcc0BdKyQvO1xuICAgIHJldHVybiBlbWFpbFJlZ2V4LnRlc3QoZW1haWwpO1xuICB9XG5cbiAgLyoqXG4gICAqIFZhbGlkYXRlIHBob25lIG51bWJlclxuICAgKi9cbiAgc3RhdGljIGlzVmFsaWRQaG9uZShwaG9uZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgY29uc3QgcGhvbmVSZWdleCA9IC9eXFwoPyhbMC05XXszfSlcXCk/Wy0uIF0/KFswLTldezN9KVstLiBdPyhbMC05XXs0fSkkLztcbiAgICByZXR1cm4gcGhvbmVSZWdleC50ZXN0KHBob25lKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDaGVjayBwYXNzd29yZCBzdHJlbmd0aFxuICAgKi9cbiAgc3RhdGljIGlzU3Ryb25nUGFzc3dvcmQocGFzc3dvcmQ6IHN0cmluZyk6IHtcbiAgICB2YWxpZDogYm9vbGVhbjtcbiAgICBlcnJvcnM6IHN0cmluZ1tdO1xuICB9IHtcbiAgICBjb25zdCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG5cbiAgICBpZiAocGFzc3dvcmQubGVuZ3RoIDwgOCkge1xuICAgICAgZXJyb3JzLnB1c2goXCJQYXNzd29yZCBtdXN0IGJlIGF0IGxlYXN0IDggY2hhcmFjdGVyc1wiKTtcbiAgICB9XG4gICAgaWYgKCEvW0EtWl0vLnRlc3QocGFzc3dvcmQpKSB7XG4gICAgICBlcnJvcnMucHVzaChcIlBhc3N3b3JkIG11c3QgY29udGFpbiB1cHBlcmNhc2UgbGV0dGVyXCIpO1xuICAgIH1cbiAgICBpZiAoIS9bYS16XS8udGVzdChwYXNzd29yZCkpIHtcbiAgICAgIGVycm9ycy5wdXNoKFwiUGFzc3dvcmQgbXVzdCBjb250YWluIGxvd2VyY2FzZSBsZXR0ZXJcIik7XG4gICAgfVxuICAgIGlmICghL1swLTldLy50ZXN0KHBhc3N3b3JkKSkge1xuICAgICAgZXJyb3JzLnB1c2goXCJQYXNzd29yZCBtdXN0IGNvbnRhaW4gbnVtYmVyXCIpO1xuICAgIH1cbiAgICBpZiAoIS9bIUAjJCVeJipdLy50ZXN0KHBhc3N3b3JkKSkge1xuICAgICAgZXJyb3JzLnB1c2goXCJQYXNzd29yZCBtdXN0IGNvbnRhaW4gc3BlY2lhbCBjaGFyYWN0ZXJcIik7XG4gICAgfVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBlcnJvcnMubGVuZ3RoID09PSAwLFxuICAgICAgZXJyb3JzLFxuICAgIH07XG4gIH1cblxuICAvKipcbiAgICogUmF0ZSBsaW1pdGluZyBjaGVja1xuICAgKi9cbiAgc3RhdGljIGNoZWNrUmF0ZUxpbWl0KFxuICAgIF9pZGVudGlmaWVyOiBzdHJpbmcsXG4gICAgX21heFJlcXVlc3RzOiBudW1iZXIsXG4gICAgX3dpbmRvd01zOiBudW1iZXJcbiAgKTogYm9vbGVhbiB7XG4gICAgLy8gSW4gcHJvZHVjdGlvbiwgdXNlIFJlZGlzIGZvciBkaXN0cmlidXRlZCByYXRlIGxpbWl0aW5nXG4gICAgcmV0dXJuIHRydWU7IC8vIFBsYWNlaG9sZGVyXG4gIH1cblxuICAvKipcbiAgICogVmFsaWRhdGUgZmlsZSB1cGxvYWRcbiAgICovXG4gIHN0YXRpYyB2YWxpZGF0ZUZpbGVVcGxvYWQoXG4gICAgZmlsZTogeyBzaXplOiBudW1iZXI7IHR5cGU6IHN0cmluZyB9LFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIG1heFNpemU6IG51bWJlcjtcbiAgICAgIGFsbG93ZWRUeXBlczogc3RyaW5nW107XG4gICAgfVxuICApOiB7IHZhbGlkOiBib29sZWFuOyBlcnJvcj86IHN0cmluZyB9IHtcbiAgICBpZiAoZmlsZS5zaXplID4gb3B0aW9ucy5tYXhTaXplKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgRmlsZSB0b28gbGFyZ2UuIE1heCBzaXplOiAke29wdGlvbnMubWF4U2l6ZSAvIDEwMjQgLyAxMDI0fU1CYCxcbiAgICAgIH07XG4gICAgfVxuXG4gICAgaWYgKCFvcHRpb25zLmFsbG93ZWRUeXBlcy5pbmNsdWRlcyhmaWxlLnR5cGUpKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB2YWxpZDogZmFsc2UsXG4gICAgICAgIGVycm9yOiBgSW52YWxpZCBmaWxlIHR5cGUuIEFsbG93ZWQ6ICR7b3B0aW9ucy5hbGxvd2VkVHlwZXMuam9pbihcIiwgXCIpfWAsXG4gICAgICB9O1xuICAgIH1cblxuICAgIHJldHVybiB7IHZhbGlkOiB0cnVlIH07XG4gIH1cbn1cbiJdLCJ2ZXJzaW9uIjozfQ==