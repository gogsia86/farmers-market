{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\security\\security.service.ts","mappings":";AAAA;;;GAGG;;;AAEH,MAAa,eAAe;IAC1B;;OAEG;IACH,MAAM,CAAC,aAAa,CAAC,KAAa;QAChC,OAAO,KAAK;aACT,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;aACrB,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;aACrB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;aACvB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;aACvB,OAAO,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IAC9B,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,YAAY,CAAC,KAAa;QAC/B,MAAM,UAAU,GAAG,4BAA4B,CAAC;QAChD,OAAO,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,YAAY,CAAC,KAAa;QAC/B,MAAM,UAAU,GAAG,oDAAoD,CAAC;QACxE,OAAO,UAAU,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,gBAAgB,CAAC,QAAgB;QAItC,MAAM,MAAM,GAAa,EAAE,CAAC;QAE5B,IAAI,QAAQ,CAAC,MAAM,GAAG,CAAC,EAAE,CAAC;YACxB,MAAM,CAAC,IAAI,CAAC,wCAAwC,CAAC,CAAC;QACxD,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC5B,MAAM,CAAC,IAAI,CAAC,wCAAwC,CAAC,CAAC;QACxD,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC5B,MAAM,CAAC,IAAI,CAAC,wCAAwC,CAAC,CAAC;QACxD,CAAC;QACD,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;YAC5B,MAAM,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC;QAC9C,CAAC;QACD,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE,CAAC;YACjC,MAAM,CAAC,IAAI,CAAC,yCAAyC,CAAC,CAAC;QACzD,CAAC;QAED,OAAO;YACL,KAAK,EAAE,MAAM,CAAC,MAAM,KAAK,CAAC;YAC1B,MAAM;SACP,CAAC;IACJ,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,cAAc,CACnB,WAAmB,EACnB,YAAoB,EACpB,SAAiB;QAEjB,yDAAyD;QACzD,OAAO,IAAI,CAAC,CAAC,cAAc;IAC7B,CAAC;IAED;;OAEG;IACH,MAAM,CAAC,kBAAkB,CACvB,IAAoC,EACpC,OAGC;QAED,IAAI,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC,OAAO,EAAE,CAAC;YAChC,OAAO;gBACL,KAAK,EAAE,KAAK;gBACZ,KAAK,EAAE,6BAA6B,OAAO,CAAC,OAAO,GAAG,IAAI,GAAG,IAAI,IAAI;aACtE,CAAC;QACJ,CAAC;QAED,IAAI,CAAC,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC;YAC9C,OAAO;gBACL,KAAK,EAAE,KAAK;gBACZ,KAAK,EAAE,+BAA+B,OAAO,CAAC,YAAY,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE;aACxE,CAAC;QACJ,CAAC;QAED,OAAO,EAAE,KAAK,EAAE,IAAI,EAAE,CAAC;IACzB,CAAC;CACF;AAlGD,0CAkGC","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\security\\security.service.ts"],"sourcesContent":["/**\n * ðŸ”’ SECURITY SERVICE\n * Handles input validation, sanitization, and security checks\n */\n\nexport class SecurityService {\n  /**\n   * Sanitize user input to prevent XSS\n   */\n  static sanitizeInput(input: string): string {\n    return input\n      .replace(/</g, \"&lt;\")\n      .replace(/>/g, \"&gt;\")\n      .replace(/\"/g, \"&quot;\")\n      .replace(/'/g, \"&#x27;\")\n      .replace(/\\//g, \"&#x2F;\");\n  }\n\n  /**\n   * Validate email format\n   */\n  static isValidEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  }\n\n  /**\n   * Validate phone number\n   */\n  static isValidPhone(phone: string): boolean {\n    const phoneRegex = /^\\(?([0-9]{3})\\)?[-. ]?([0-9]{3})[-. ]?([0-9]{4})$/;\n    return phoneRegex.test(phone);\n  }\n\n  /**\n   * Check password strength\n   */\n  static isStrongPassword(password: string): {\n    valid: boolean;\n    errors: string[];\n  } {\n    const errors: string[] = [];\n\n    if (password.length < 8) {\n      errors.push(\"Password must be at least 8 characters\");\n    }\n    if (!/[A-Z]/.test(password)) {\n      errors.push(\"Password must contain uppercase letter\");\n    }\n    if (!/[a-z]/.test(password)) {\n      errors.push(\"Password must contain lowercase letter\");\n    }\n    if (!/[0-9]/.test(password)) {\n      errors.push(\"Password must contain number\");\n    }\n    if (!/[!@#$%^&*]/.test(password)) {\n      errors.push(\"Password must contain special character\");\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * Rate limiting check\n   */\n  static checkRateLimit(\n    _identifier: string,\n    _maxRequests: number,\n    _windowMs: number\n  ): boolean {\n    // In production, use Redis for distributed rate limiting\n    return true; // Placeholder\n  }\n\n  /**\n   * Validate file upload\n   */\n  static validateFileUpload(\n    file: { size: number; type: string },\n    options: {\n      maxSize: number;\n      allowedTypes: string[];\n    }\n  ): { valid: boolean; error?: string } {\n    if (file.size > options.maxSize) {\n      return {\n        valid: false,\n        error: `File too large. Max size: ${options.maxSize / 1024 / 1024}MB`,\n      };\n    }\n\n    if (!options.allowedTypes.includes(file.type)) {\n      return {\n        valid: false,\n        error: `Invalid file type. Allowed: ${options.allowedTypes.join(\", \")}`,\n      };\n    }\n\n    return { valid: true };\n  }\n}\n"],"version":3}