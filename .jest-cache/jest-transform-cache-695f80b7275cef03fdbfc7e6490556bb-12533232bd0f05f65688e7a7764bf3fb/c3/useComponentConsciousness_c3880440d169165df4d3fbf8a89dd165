8468099ed561e8db00a0e14664822f07
"use strict";
/**
 * ðŸ§  DIVINE PATTERN: Component Consciousness Tracking
 * ðŸ“š Reference: 01_DIVINE_CORE_PRINCIPLES.instructions.md
 * ðŸŒ¾ Domain: Agricultural Component Monitoring
 * âš¡ Performance: Quantum Performance Measurement
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.useComponentConsciousness = useComponentConsciousness;
exports.initializeDivinePerformanceTracking = initializeDivinePerformanceTracking;
const react_1 = require("react");
/**
 * DIVINE HOOK: useComponentConsciousness
 *
 * Provides component-level consciousness tracking for performance,
 * errors, and user interactions. Follows agricultural quantum patterns.
 *
 * @example
 * ```tsx
 * const consciousness = useComponentConsciousness('FarmCard', { variant: 'agricultural' });
 *
 * const handleClick = async (e) => {
 *   const measurement = consciousness.startMeasurement('click');
 *   try {
 *     await onClick?.(e);
 *     measurement.success();
 *   } catch (error) {
 *     measurement.failure(error);
 *   }
 * };
 * ```
 */
function useComponentConsciousness(componentName, context) {
    // Metrics storage
    const metricsRef = (0, react_1.useRef)({
        componentName,
        renderCount: 0,
        lastRenderTime: 0,
        averageRenderTime: 0,
        errorCount: 0,
        eventCount: 0,
    });
    const renderTimesRef = (0, react_1.useRef)([]);
    const renderStartRef = (0, react_1.useRef)(0);
    // Track render start
    (0, react_1.useEffect)(() => {
        renderStartRef.current = performance.now();
    });
    // Track render end
    (0, react_1.useEffect)(() => {
        const renderTime = performance.now() - renderStartRef.current;
        metricsRef.current.renderCount += 1;
        metricsRef.current.lastRenderTime = renderTime;
        renderTimesRef.current.push(renderTime);
        // Keep only last 100 render times for average calculation
        if (renderTimesRef.current.length > 100) {
            renderTimesRef.current.shift();
        }
        // Calculate average render time
        metricsRef.current.averageRenderTime =
            renderTimesRef.current.reduce((sum, time) => sum + time, 0) /
                renderTimesRef.current.length;
        // Log slow renders (development only)
        if (process.env.NODE_ENV === "development" && renderTime > 16) {
            console.warn(`ðŸŒ Slow render detected in ${componentName}:`, `${renderTime.toFixed(2)}ms`, context);
        }
    });
    /**
     * Start performance measurement for an operation
     */
    const measurements = (0, react_1.useRef)(new Map());
    const errors = (0, react_1.useRef)([]);
    const startMeasurement = (0, react_1.useCallback)((operationName) => {
        const startTime = performance.now();
        return {
            operationName,
            startTime,
            success: () => {
                const duration = performance.now() - startTime;
                // Store internally
                measurements.current.set(operationName, {
                    name: operationName,
                    duration,
                    success: true,
                    timestamp: new Date(),
                });
                // Record in global tracker if available
                if (globalThis.__DIVINE_PERFORMANCE__) {
                    globalThis.__DIVINE_PERFORMANCE__.recordMetric({
                        component: componentName,
                        operation: operationName,
                        duration,
                        success: true,
                        timestamp: Date.now(),
                    });
                }
            },
            failure: (error) => {
                const duration = performance.now() - startTime;
                const err = error instanceof Error ? error : new Error(String(error));
                errors.current.push(err);
                // Increment error count
                metricsRef.current.errorCount += 1;
                const errorMessage = err.message;
                // Store internally
                measurements.current.set(operationName, {
                    name: operationName,
                    duration,
                    success: false,
                    timestamp: new Date(),
                    error: err,
                });
                // Record in global tracker if available
                if (globalThis.__DIVINE_PERFORMANCE__) {
                    globalThis.__DIVINE_PERFORMANCE__.recordMetric({
                        component: componentName,
                        operation: operationName,
                        duration,
                        success: false,
                        error: errorMessage,
                        timestamp: Date.now(),
                    });
                }
            },
        };
    }, [componentName]); /**
     * Track custom events (clicks, interactions, etc.)
     */
    const trackEvent = (0, react_1.useCallback)((eventName, metadata) => {
        metricsRef.current.eventCount += 1;
        if (process.env.NODE_ENV === "development") {
            console.debug(`ðŸ“Š ${componentName}.${eventName}`, metadata);
        }
        // Track in analytics (if available)
        if (typeof window !== "undefined" && window.__DIVINE_ANALYTICS__) {
            window.__DIVINE_ANALYTICS__.track({
                component: componentName,
                event: eventName,
                metadata,
                context,
                timestamp: Date.now(),
            });
        }
    }, [componentName, context]);
    /**
     * Track user interactions (alias for trackEvent for consistency)
     */
    const trackInteraction = (0, react_1.useCallback)((eventName, metadata) => {
        trackEvent(eventName, metadata);
    }, [trackEvent]);
    /**
     * Capture and report errors
     */
    const captureError = (0, react_1.useCallback)((errorName, error) => {
        metricsRef.current.errorCount += 1;
        let errorMessage;
        if (error instanceof Error) {
            errorMessage = error.message;
        }
        else if (typeof error === "string") {
            errorMessage = error;
        }
        else {
            errorMessage = String(error);
        }
        console.error(`âŒ ${componentName}.${errorName}:`, error);
        // Track error in monitoring (if available)
        if (globalThis.__DIVINE_PERFORMANCE__) {
            globalThis.__DIVINE_PERFORMANCE__.recordMetric({
                component: componentName,
                operation: errorName,
                duration: 0,
                success: false,
                error: errorMessage,
                timestamp: Date.now(),
            });
        }
    }, [componentName]);
    /**
     * Get current component metrics
     */
    const getMetrics = (0, react_1.useCallback)(() => {
        return { ...metricsRef.current };
    }, []);
    return {
        startMeasurement,
        trackEvent,
        trackInteraction,
        captureError,
        getMetrics,
    };
}
/**
 * DIVINE UTILITY: Create global performance tracking system
 *
 * Initialize this in your root layout or _app.tsx to enable
 * global performance tracking across all components.
 */
function initializeDivinePerformanceTracking() {
    if (globalThis.window === undefined)
        return;
    const metrics = [];
    globalThis.__DIVINE_PERFORMANCE__ = {
        recordMetric: (metric) => {
            metrics.push(metric);
            // Keep only last 1000 metrics
            if (metrics.length > 1000) {
                metrics.shift();
            }
        },
        getMetrics: () => metrics,
        getComponentMetrics: (componentName) => metrics.filter((m) => m.component === componentName),
        clearMetrics: () => {
            metrics.length = 0;
        },
    };
    globalThis.__DIVINE_ANALYTICS__ = {
        track: (event) => {
            // Integration point for analytics services
            console.debug("ðŸ“Š Analytics event:", event);
        },
    };
    console.log("âœ¨ Divine Performance Tracking initialized");
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiTTpcXFJlcG9cXEZhcm1lcnMgTWFya2V0IFBsYXRmb3JtIHdlYiBhbmQgYXBwXFxzcmNcXGhvb2tzXFx1c2VDb21wb25lbnRDb25zY2lvdXNuZXNzLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7R0FLRzs7QUE4R0gsOERBME1DO0FBUUQsa0ZBOEJDO0FBNVZELGlDQUF1RDtBQXVGdkQ7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBb0JHO0FBQ0gsU0FBZ0IseUJBQXlCLENBQ3ZDLGFBQXFCLEVBQ3JCLE9BQWlDO0lBRWpDLGtCQUFrQjtJQUNsQixNQUFNLFVBQVUsR0FBRyxJQUFBLGNBQU0sRUFBbUI7UUFDMUMsYUFBYTtRQUNiLFdBQVcsRUFBRSxDQUFDO1FBQ2QsY0FBYyxFQUFFLENBQUM7UUFDakIsaUJBQWlCLEVBQUUsQ0FBQztRQUNwQixVQUFVLEVBQUUsQ0FBQztRQUNiLFVBQVUsRUFBRSxDQUFDO0tBQ2QsQ0FBQyxDQUFDO0lBRUgsTUFBTSxjQUFjLEdBQUcsSUFBQSxjQUFNLEVBQVcsRUFBRSxDQUFDLENBQUM7SUFDNUMsTUFBTSxjQUFjLEdBQUcsSUFBQSxjQUFNLEVBQVMsQ0FBQyxDQUFDLENBQUM7SUFFekMscUJBQXFCO0lBQ3JCLElBQUEsaUJBQVMsRUFBQyxHQUFHLEVBQUU7UUFDYixjQUFjLENBQUMsT0FBTyxHQUFHLFdBQVcsQ0FBQyxHQUFHLEVBQUUsQ0FBQztJQUM3QyxDQUFDLENBQUMsQ0FBQztJQUVILG1CQUFtQjtJQUNuQixJQUFBLGlCQUFTLEVBQUMsR0FBRyxFQUFFO1FBQ2IsTUFBTSxVQUFVLEdBQUcsV0FBVyxDQUFDLEdBQUcsRUFBRSxHQUFHLGNBQWMsQ0FBQyxPQUFPLENBQUM7UUFFOUQsVUFBVSxDQUFDLE9BQU8sQ0FBQyxXQUFXLElBQUksQ0FBQyxDQUFDO1FBQ3BDLFVBQVUsQ0FBQyxPQUFPLENBQUMsY0FBYyxHQUFHLFVBQVUsQ0FBQztRQUUvQyxjQUFjLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztRQUV4QywwREFBMEQ7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QUFDLENBQUM7UUFDOUMsQ0FBQztLQUNGLENBQUM7SUFFRixPQUFPLENBQUMsR0FBRyxDQUFDLDJDQUEyQyxDQUFDLENBQUM7QUFDM0QsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJNOlxcUmVwb1xcRmFybWVycyBNYXJrZXQgUGxhdGZvcm0gd2ViIGFuZCBhcHBcXHNyY1xcaG9va3NcXHVzZUNvbXBvbmVudENvbnNjaW91c25lc3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiDwn6egIERJVklORSBQQVRURVJOOiBDb21wb25lbnQgQ29uc2Npb3VzbmVzcyBUcmFja2luZ1xuICog8J+TmiBSZWZlcmVuY2U6IDAxX0RJVklORV9DT1JFX1BSSU5DSVBMRVMuaW5zdHJ1Y3Rpb25zLm1kXG4gKiDwn4y+IERvbWFpbjogQWdyaWN1bHR1cmFsIENvbXBvbmVudCBNb25pdG9yaW5nXG4gKiDimqEgUGVyZm9ybWFuY2U6IFF1YW50dW0gUGVyZm9ybWFuY2UgTWVhc3VyZW1lbnRcbiAqL1xuXG5pbXBvcnQgeyB1c2VDYWxsYmFjaywgdXNlRWZmZWN0LCB1c2VSZWYgfSBmcm9tIFwicmVhY3RcIjtcblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRDb250ZXh0IHtcbiAgY29tcG9uZW50TmFtZTogc3RyaW5nO1xuICB2YXJpYW50Pzogc3RyaW5nO1xuICBzaXplPzogc3RyaW5nO1xuICBba2V5OiBzdHJpbmddOiB1bmtub3duO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFBlcmZvcm1hbmNlTWVhc3VyZW1lbnQge1xuICBvcGVyYXRpb25OYW1lOiBzdHJpbmc7XG4gIHN0YXJ0VGltZTogbnVtYmVyO1xuICBzdWNjZXNzOiAoKSA9PiB2b2lkO1xuICBmYWlsdXJlOiAoZXJyb3I6IEVycm9yIHwgdW5rbm93bikgPT4gdm9pZDtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRDb25zY2lvdXNuZXNzIHtcbiAgc3RhcnRNZWFzdXJlbWVudDogKG9wZXJhdGlvbk5hbWU6IHN0cmluZykgPT4gUGVyZm9ybWFuY2VNZWFzdXJlbWVudDtcbiAgdHJhY2tFdmVudDogKGV2ZW50TmFtZTogc3RyaW5nLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSA9PiB2b2lkO1xuICB0cmFja0ludGVyYWN0aW9uOiAoXG4gICAgZXZlbnROYW1lOiBzdHJpbmcsXG4gICAgbWV0YWRhdGE/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuICApID0+IHZvaWQ7XG4gIGNhcHR1cmVFcnJvcjogKGVycm9yTmFtZTogc3RyaW5nLCBlcnJvcjogdW5rbm93bikgPT4gdm9pZDtcbiAgZ2V0TWV0cmljczogKCkgPT4gQ29tcG9uZW50TWV0cmljcztcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDb21wb25lbnRNZXRyaWNzIHtcbiAgY29tcG9uZW50TmFtZTogc3RyaW5nO1xuICByZW5kZXJDb3VudDogbnVtYmVyO1xuICBsYXN0UmVuZGVyVGltZTogbnVtYmVyO1xuICBhdmVyYWdlUmVuZGVyVGltZTogbnVtYmVyO1xuICBlcnJvckNvdW50OiBudW1iZXI7XG4gIGV2ZW50Q291bnQ6IG51bWJlcjtcbn1cblxuLyoqXG4gKiBEaXZpbmUgUGVyZm9ybWFuY2UgVHJhY2tlciBJbnRlcmZhY2VcbiAqIEdsb2JhbCB3aW5kb3cgaW50ZXJmYWNlIGZvciBwZXJmb3JtYW5jZSBtb25pdG9yaW5nXG4gKi9cbmV4cG9ydCBpbnRlcmZhY2UgRGl2aW5lUGVyZm9ybWFuY2VNZXRyaWMge1xuICBjb21wb25lbnQ6IHN0cmluZztcbiAgb3BlcmF0aW9uOiBzdHJpbmc7XG4gIGR1cmF0aW9uOiBudW1iZXI7XG4gIHN1Y2Nlc3M6IGJvb2xlYW47XG4gIGVycm9yPzogc3RyaW5nO1xuICB0aW1lc3RhbXA6IG51bWJlcjtcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEaXZpbmVQZXJmb3JtYW5jZVRyYWNrZXIge1xuICByZWNvcmRNZXRyaWM6IChtZXRyaWM6IERpdmluZVBlcmZvcm1hbmNlTWV0cmljKSA9PiB2b2lkO1xuICBnZXRNZXRyaWNzOiAoKSA9PiBEaXZpbmVQZXJmb3JtYW5jZU1ldHJpY1tdO1xuICBnZXRDb21wb25lbnRNZXRyaWNzOiAoY29tcG9uZW50TmFtZTogc3RyaW5nKSA9PiBEaXZpbmVQZXJmb3JtYW5jZU1ldHJpY1tdO1xuICBjbGVhck1ldHJpY3M6ICgpID0+IHZvaWQ7XG59XG5cbi8qKlxuICogRGl2aW5lIEFuYWx5dGljcyBUcmFja2VyIEludGVyZmFjZVxuICogR2xvYmFsIHdpbmRvdyBpbnRlcmZhY2UgZm9yIGFuYWx5dGljcyB0cmFja2luZ1xuICovXG5leHBvcnQgaW50ZXJmYWNlIERpdmluZUFuYWx5dGljc0V2ZW50IHtcbiAgY29tcG9uZW50OiBzdHJpbmc7XG4gIGV2ZW50OiBzdHJpbmc7XG4gIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj47XG4gIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPjtcbiAgdGltZXN0YW1wOiBudW1iZXI7XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRGl2aW5lQW5hbHl0aWNzVHJhY2tlciB7XG4gIHRyYWNrOiAoZXZlbnQ6IERpdmluZUFuYWx5dGljc0V2ZW50KSA9PiB2b2lkO1xufVxuXG4vKipcbiAqIEV4dGVuZGVkIFdpbmRvdyBhbmQgR2xvYmFsIEludGVyZmFjZVxuICovXG5kZWNsYXJlIGdsb2JhbCB7XG4gIGludGVyZmFjZSBXaW5kb3cge1xuICAgIF9fRElWSU5FX1BFUkZPUk1BTkNFX18/OiBEaXZpbmVQZXJmb3JtYW5jZVRyYWNrZXI7XG4gICAgX19ESVZJTkVfQU5BTFlUSUNTX18/OiBEaXZpbmVBbmFseXRpY3NUcmFja2VyO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXZhclxuICB2YXIgX19ESVZJTkVfUEVSRk9STUFOQ0VfXzogRGl2aW5lUGVyZm9ybWFuY2VUcmFja2VyIHwgdW5kZWZpbmVkO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdmFyXG4gIHZhciBfX0RJVklORV9BTkFMWVRJQ1NfXzogRGl2aW5lQW5hbHl0aWNzVHJhY2tlciB8IHVuZGVmaW5lZDtcbn1cblxuLyoqXG4gKiBESVZJTkUgSE9PSzogdXNlQ29tcG9uZW50Q29uc2Npb3VzbmVzc1xuICpcbiAqIFByb3ZpZGVzIGNvbXBvbmVudC1sZXZlbCBjb25zY2lvdXNuZXNzIHRyYWNraW5nIGZvciBwZXJmb3JtYW5jZSxcbiAqIGVycm9ycywgYW5kIHVzZXIgaW50ZXJhY3Rpb25zLiBGb2xsb3dzIGFncmljdWx0dXJhbCBxdWFudHVtIHBhdHRlcm5zLlxuICpcbiAqIEBleGFtcGxlXG4gKiBgYGB0c3hcbiAqIGNvbnN0IGNvbnNjaW91c25lc3MgPSB1c2VDb21wb25lbnRDb25zY2lvdXNuZXNzKCdGYXJtQ2FyZCcsIHsgdmFyaWFudDogJ2FncmljdWx0dXJhbCcgfSk7XG4gKlxuICogY29uc3QgaGFuZGxlQ2xpY2sgPSBhc3luYyAoZSkgPT4ge1xuICogICBjb25zdCBtZWFzdXJlbWVudCA9IGNvbnNjaW91c25lc3Muc3RhcnRNZWFzdXJlbWVudCgnY2xpY2snKTtcbiAqICAgdHJ5IHtcbiAqICAgICBhd2FpdCBvbkNsaWNrPy4oZSk7XG4gKiAgICAgbWVhc3VyZW1lbnQuc3VjY2VzcygpO1xuICogICB9IGNhdGNoIChlcnJvcikge1xuICogICAgIG1lYXN1cmVtZW50LmZhaWx1cmUoZXJyb3IpO1xuICogICB9XG4gKiB9O1xuICogYGBgXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB1c2VDb21wb25lbnRDb25zY2lvdXNuZXNzKFxuICBjb21wb25lbnROYW1lOiBzdHJpbmcsXG4gIGNvbnRleHQ/OiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPlxuKTogQ29tcG9uZW50Q29uc2Npb3VzbmVzcyB7XG4gIC8vIE1ldHJpY3Mgc3RvcmFnZVxuICBjb25zdCBtZXRyaWNzUmVmID0gdXNlUmVmPENvbXBvbmVudE1ldHJpY3M+KHtcbiAgICBjb21wb25lbnROYW1lLFxuICAgIHJlbmRlckNvdW50OiAwLFxuICAgIGxhc3RSZW5kZXJUaW1lOiAwLFxuICAgIGF2ZXJhZ2VSZW5kZXJUaW1lOiAwLFxuICAgIGVycm9yQ291bnQ6IDAsXG4gICAgZXZlbnRDb3VudDogMCxcbiAgfSk7XG5cbiAgY29uc3QgcmVuZGVyVGltZXNSZWYgPSB1c2VSZWY8bnVtYmVyW10+KFtdKTtcbiAgY29uc3QgcmVuZGVyU3RhcnRSZWYgPSB1c2VSZWY8bnVtYmVyPigwKTtcblxuICAvLyBUcmFjayByZW5kZXIgc3RhcnRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICByZW5kZXJTdGFydFJlZi5jdXJyZW50ID0gcGVyZm9ybWFuY2Uubm93KCk7XG4gIH0pO1xuXG4gIC8vIFRyYWNrIHJlbmRlciBlbmRcbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBjb25zdCByZW5kZXJUaW1lID0gcGVyZm9ybWFuY2Uubm93KCkgLSByZW5kZXJTdGFydFJlZi5jdXJyZW50O1xuXG4gICAgbWV0cmljc1JlZi5jdXJyZW50LnJlbmRlckNvdW50ICs9IDE7XG4gICAgbWV0cmljc1JlZi5jdXJyZW50Lmxhc3RSZW5kZXJUaW1lID0gcmVuZGVyVGltZTtcblxuICAgIHJlbmRlclRpbWVzUmVmLmN1cnJlbnQucHVzaChyZW5kZXJUaW1lKTtcblxuICAgIC8vIEtlZXAgb25seSBsYXN0IDEwMCByZW5kZXIgdGltZXMgZm9yIGF2ZXJhZ2UgY2FsY3VsYXRpb25cbiAgICBpZiAocmVuZGVyVGltZXNSZWYuY3VycmVudC5sZW5ndGggPiAxMDApIHtcbiAgICAgIHJlbmRlclRpbWVzUmVmLmN1cnJlbnQuc2hpZnQoKTtcbiAgICB9XG5cbiAgICAvLyBDYWxjdWxhdGUgYXZlcmFnZSByZW5kZXIgdGltZVxuICAgIG1ldHJpY3NSZWYuY3VycmVudC5hdmVyYWdlUmVuZGVyVGltZSA9XG4gICAgICByZW5kZXJUaW1lc1JlZi5jdXJyZW50LnJlZHVjZSgoc3VtLCB0aW1lKSA9PiBzdW0gKyB0aW1lLCAwKSAvXG4gICAgICByZW5kZXJUaW1lc1JlZi5jdXJyZW50Lmxlbmd0aDtcblxuICAgIC8vIExvZyBzbG93IHJlbmRlcnMgKGRldmVsb3BtZW50IG9ubHkpXG4gICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSBcImRldmVsb3BtZW50XCIgJiYgcmVuZGVyVGltZSA+IDE2KSB7XG4gICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgIGDwn5CMIFNsb3cgcmVuZGVyIGRldGVjdGVkIGluICR7Y29tcG9uZW50TmFtZX06YCxcbiAgICAgICAgYCR7cmVuZGVyVGltZS50b0ZpeGVkKDIpfW1zYCxcbiAgICAgICAgY29udGV4dFxuICAgICAgKTtcbiAgICB9XG4gIH0pO1xuXG4gIC8qKlxuICAgKiBTdGFydCBwZXJmb3JtYW5jZSBtZWFzdXJlbWVudCBmb3IgYW4gb3BlcmF0aW9uXG4gICAqL1xuICBjb25zdCBtZWFzdXJlbWVudHMgPSB1c2VSZWYobmV3IE1hcDxzdHJpbmcsIFBlcmZvcm1hbmNlTWVhc3VyZW1lbnQ+KCkpO1xuICBjb25zdCBlcnJvcnMgPSB1c2VSZWY8RXJyb3JbXT4oW10pO1xuXG4gIGNvbnN0IHN0YXJ0TWVhc3VyZW1lbnQgPSB1c2VDYWxsYmFjayhcbiAgICAob3BlcmF0aW9uTmFtZTogc3RyaW5nKSA9PiB7XG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBwZXJmb3JtYW5jZS5ub3coKTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgb3BlcmF0aW9uTmFtZSxcbiAgICAgICAgc3RhcnRUaW1lLFxuICAgICAgICBzdWNjZXNzOiAoKSA9PiB7XG4gICAgICAgICAgY29uc3QgZHVyYXRpb24gPSBwZXJmb3JtYW5jZS5ub3coKSAtIHN0YXJ0VGltZTtcblxuICAgICAgICAgIC8vIFN0b3JlIGludGVybmFsbHlcbiAgICAgICAgICBtZWFzdXJlbWVudHMuY3VycmVudC5zZXQob3BlcmF0aW9uTmFtZSwge1xuICAgICAgICAgICAgbmFtZTogb3BlcmF0aW9uTmFtZSxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcbiAgICAgICAgICB9KTtcblxuICAgICAgICAgIC8vIFJlY29yZCBpbiBnbG9iYWwgdHJhY2tlciBpZiBhdmFpbGFibGVcbiAgICAgICAgICBpZiAoZ2xvYmFsVGhpcy5fX0RJVklORV9QRVJGT1JNQU5DRV9fKSB7XG4gICAgICAgICAgICBnbG9iYWxUaGlzLl9fRElWSU5FX1BFUkZPUk1BTkNFX18ucmVjb3JkTWV0cmljKHtcbiAgICAgICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnROYW1lLFxuICAgICAgICAgICAgICBvcGVyYXRpb246IG9wZXJhdGlvbk5hbWUsXG4gICAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIGZhaWx1cmU6IChlcnJvcjogdW5rbm93bikgPT4ge1xuICAgICAgICAgIGNvbnN0IGR1cmF0aW9uID0gcGVyZm9ybWFuY2Uubm93KCkgLSBzdGFydFRpbWU7XG4gICAgICAgICAgY29uc3QgZXJyID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yIDogbmV3IEVycm9yKFN0cmluZyhlcnJvcikpO1xuICAgICAgICAgIGVycm9ycy5jdXJyZW50LnB1c2goZXJyKTtcblxuICAgICAgICAgIC8vIEluY3JlbWVudCBlcnJvciBjb3VudFxuICAgICAgICAgIG1ldHJpY3NSZWYuY3VycmVudC5lcnJvckNvdW50ICs9IDE7XG5cbiAgICAgICAgICBjb25zdCBlcnJvck1lc3NhZ2UgPSBlcnIubWVzc2FnZTtcblxuICAgICAgICAgIC8vIFN0b3JlIGludGVybmFsbHlcbiAgICAgICAgICBtZWFzdXJlbWVudHMuY3VycmVudC5zZXQob3BlcmF0aW9uTmFtZSwge1xuICAgICAgICAgICAgbmFtZTogb3BlcmF0aW9uTmFtZSxcbiAgICAgICAgICAgIGR1cmF0aW9uLFxuICAgICAgICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICAgICAgICB0aW1lc3RhbXA6IG5ldyBEYXRlKCksXG4gICAgICAgICAgICBlcnJvcjogZXJyLFxuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgLy8gUmVjb3JkIGluIGdsb2JhbCB0cmFja2VyIGlmIGF2YWlsYWJsZVxuICAgICAgICAgIGlmIChnbG9iYWxUaGlzLl9fRElWSU5FX1BFUkZPUk1BTkNFX18pIHtcbiAgICAgICAgICAgIGdsb2JhbFRoaXMuX19ESVZJTkVfUEVSRk9STUFOQ0VfXy5yZWNvcmRNZXRyaWMoe1xuICAgICAgICAgICAgICBjb21wb25lbnQ6IGNvbXBvbmVudE5hbWUsXG4gICAgICAgICAgICAgIG9wZXJhdGlvbjogb3BlcmF0aW9uTmFtZSxcbiAgICAgICAgICAgICAgZHVyYXRpb24sXG4gICAgICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgICAgICBlcnJvcjogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICB9O1xuICAgIH0sXG4gICAgW2NvbXBvbmVudE5hbWVdXG4gICk7IC8qKlxuICAgKiBUcmFjayBjdXN0b20gZXZlbnRzIChjbGlja3MsIGludGVyYWN0aW9ucywgZXRjLilcbiAgICovXG4gIGNvbnN0IHRyYWNrRXZlbnQgPSB1c2VDYWxsYmFjayhcbiAgICAoZXZlbnROYW1lOiBzdHJpbmcsIG1ldGFkYXRhPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj4pID0+IHtcbiAgICAgIG1ldHJpY3NSZWYuY3VycmVudC5ldmVudENvdW50ICs9IDE7XG5cbiAgICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gXCJkZXZlbG9wbWVudFwiKSB7XG4gICAgICAgIGNvbnNvbGUuZGVidWcoYPCfk4ogJHtjb21wb25lbnROYW1lfS4ke2V2ZW50TmFtZX1gLCBtZXRhZGF0YSk7XG4gICAgICB9XG5cbiAgICAgIC8vIFRyYWNrIGluIGFuYWx5dGljcyAoaWYgYXZhaWxhYmxlKVxuICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93Ll9fRElWSU5FX0FOQUxZVElDU19fKSB7XG4gICAgICAgIHdpbmRvdy5fX0RJVklORV9BTkFMWVRJQ1NfXy50cmFjayh7XG4gICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnROYW1lLFxuICAgICAgICAgIGV2ZW50OiBldmVudE5hbWUsXG4gICAgICAgICAgbWV0YWRhdGEsXG4gICAgICAgICAgY29udGV4dCxcbiAgICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0sXG4gICAgW2NvbXBvbmVudE5hbWUsIGNvbnRleHRdXG4gICk7XG5cbiAgLyoqXG4gICAqIFRyYWNrIHVzZXIgaW50ZXJhY3Rpb25zIChhbGlhcyBmb3IgdHJhY2tFdmVudCBmb3IgY29uc2lzdGVuY3kpXG4gICAqL1xuICBjb25zdCB0cmFja0ludGVyYWN0aW9uID0gdXNlQ2FsbGJhY2soXG4gICAgKGV2ZW50TmFtZTogc3RyaW5nLCBtZXRhZGF0YT86IFJlY29yZDxzdHJpbmcsIHVua25vd24+KSA9PiB7XG4gICAgICB0cmFja0V2ZW50KGV2ZW50TmFtZSwgbWV0YWRhdGEpO1xuICAgIH0sXG4gICAgW3RyYWNrRXZlbnRdXG4gICk7XG5cbiAgLyoqXG4gICAqIENhcHR1cmUgYW5kIHJlcG9ydCBlcnJvcnNcbiAgICovXG4gIGNvbnN0IGNhcHR1cmVFcnJvciA9IHVzZUNhbGxiYWNrKFxuICAgIChlcnJvck5hbWU6IHN0cmluZywgZXJyb3I6IHVua25vd24pID0+IHtcbiAgICAgIG1ldHJpY3NSZWYuY3VycmVudC5lcnJvckNvdW50ICs9IDE7XG5cbiAgICAgIGxldCBlcnJvck1lc3NhZ2U6IHN0cmluZztcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XG4gICAgICB9IGVsc2UgaWYgKHR5cGVvZiBlcnJvciA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICBlcnJvck1lc3NhZ2UgPSBlcnJvcjtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVycm9yTWVzc2FnZSA9IFN0cmluZyhlcnJvcik7XG4gICAgICB9XG5cbiAgICAgIGNvbnNvbGUuZXJyb3IoYOKdjCAke2NvbXBvbmVudE5hbWV9LiR7ZXJyb3JOYW1lfTpgLCBlcnJvcik7XG5cbiAgICAgIC8vIFRyYWNrIGVycm9yIGluIG1vbml0b3JpbmcgKGlmIGF2YWlsYWJsZSlcbiAgICAgIGlmIChnbG9iYWxUaGlzLl9fRElWSU5FX1BFUkZPUk1BTkNFX18pIHtcbiAgICAgICAgZ2xvYmFsVGhpcy5fX0RJVklORV9QRVJGT1JNQU5DRV9fLnJlY29yZE1ldHJpYyh7XG4gICAgICAgICAgY29tcG9uZW50OiBjb21wb25lbnROYW1lLFxuICAgICAgICAgIG9wZXJhdGlvbjogZXJyb3JOYW1lLFxuICAgICAgICAgIGR1cmF0aW9uOiAwLFxuICAgICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICAgIGVycm9yOiBlcnJvck1lc3NhZ2UsXG4gICAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9LFxuICAgIFtjb21wb25lbnROYW1lXVxuICApO1xuXG4gIC8qKlxuICAgKiBHZXQgY3VycmVudCBjb21wb25lbnQgbWV0cmljc1xuICAgKi9cbiAgY29uc3QgZ2V0TWV0cmljcyA9IHVzZUNhbGxiYWNrKCgpOiBDb21wb25lbnRNZXRyaWNzID0+IHtcbiAgICByZXR1cm4geyAuLi5tZXRyaWNzUmVmLmN1cnJlbnQgfTtcbiAgfSwgW10pO1xuXG4gIHJldHVybiB7XG4gICAgc3RhcnRNZWFzdXJlbWVudCxcbiAgICB0cmFja0V2ZW50LFxuICAgIHRyYWNrSW50ZXJhY3Rpb24sXG4gICAgY2FwdHVyZUVycm9yLFxuICAgIGdldE1ldHJpY3MsXG4gIH07XG59XG5cbi8qKlxuICogRElWSU5FIFVUSUxJVFk6IENyZWF0ZSBnbG9iYWwgcGVyZm9ybWFuY2UgdHJhY2tpbmcgc3lzdGVtXG4gKlxuICogSW5pdGlhbGl6ZSB0aGlzIGluIHlvdXIgcm9vdCBsYXlvdXQgb3IgX2FwcC50c3ggdG8gZW5hYmxlXG4gKiBnbG9iYWwgcGVyZm9ybWFuY2UgdHJhY2tpbmcgYWNyb3NzIGFsbCBjb21wb25lbnRzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gaW5pdGlhbGl6ZURpdmluZVBlcmZvcm1hbmNlVHJhY2tpbmcoKSB7XG4gIGlmIChnbG9iYWxUaGlzLndpbmRvdyA9PT0gdW5kZWZpbmVkKSByZXR1cm47XG5cbiAgY29uc3QgbWV0cmljczogRGl2aW5lUGVyZm9ybWFuY2VNZXRyaWNbXSA9IFtdO1xuXG4gIGdsb2JhbFRoaXMuX19ESVZJTkVfUEVSRk9STUFOQ0VfXyA9IHtcbiAgICByZWNvcmRNZXRyaWM6IChtZXRyaWM6IERpdmluZVBlcmZvcm1hbmNlTWV0cmljKSA9PiB7XG4gICAgICBtZXRyaWNzLnB1c2gobWV0cmljKTtcblxuICAgICAgLy8gS2VlcCBvbmx5IGxhc3QgMTAwMCBtZXRyaWNzXG4gICAgICBpZiAobWV0cmljcy5sZW5ndGggPiAxMDAwKSB7XG4gICAgICAgIG1ldHJpY3Muc2hpZnQoKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGdldE1ldHJpY3M6ICgpID0+IG1ldHJpY3MsXG4gICAgZ2V0Q29tcG9uZW50TWV0cmljczogKGNvbXBvbmVudE5hbWU6IHN0cmluZykgPT5cbiAgICAgIG1ldHJpY3MuZmlsdGVyKChtKSA9PiBtLmNvbXBvbmVudCA9PT0gY29tcG9uZW50TmFtZSksXG4gICAgY2xlYXJNZXRyaWNzOiAoKSA9PiB7XG4gICAgICBtZXRyaWNzLmxlbmd0aCA9IDA7XG4gICAgfSxcbiAgfTtcblxuICBnbG9iYWxUaGlzLl9fRElWSU5FX0FOQUxZVElDU19fID0ge1xuICAgIHRyYWNrOiAoZXZlbnQ6IERpdmluZUFuYWx5dGljc0V2ZW50KSA9PiB7XG4gICAgICAvLyBJbnRlZ3JhdGlvbiBwb2ludCBmb3IgYW5hbHl0aWNzIHNlcnZpY2VzXG4gICAgICBjb25zb2xlLmRlYnVnKFwi8J+TiiBBbmFseXRpY3MgZXZlbnQ6XCIsIGV2ZW50KTtcbiAgICB9LFxuICB9O1xuXG4gIGNvbnNvbGUubG9nKFwi4pyoIERpdmluZSBQZXJmb3JtYW5jZSBUcmFja2luZyBpbml0aWFsaXplZFwiKTtcbn1cbiJdLCJ2ZXJzaW9uIjozfQ==