{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\__tests__\\rate-limit.test.ts","mappings":";AAAA;;;GAGG;;AAEH,2CAA4E;AAC5E,8CASuB;AAEvB,IAAA,kBAAQ,EAAC,mBAAmB,EAAE,GAAG,EAAE;IACjC,IAAA,oBAAU,EAAC,GAAG,EAAE;QACd,IAAA,+BAAkB,GAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,IAAA,mBAAS,EAAC,GAAG,EAAE;QACb,IAAA,+BAAkB,GAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,IAAA,YAAE,EAAC,oCAAoC,EAAE,GAAG,EAAE;YAC5C,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,aAAa,CAAC;YAEjC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC3B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;gBAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;gBAClC,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;gBACrC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACrC,CAAC;QACH,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,uCAAuC,EAAE,GAAG,EAAE;YAC/C,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,aAAa,CAAC;YAEjC,qCAAqC;YACrC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC3B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;gBAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;YAED,gCAAgC;YAChC,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACnC,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACjC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;YACtD,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAE,CAAC,CAAC,eAAe;YACjE,MAAM,UAAU,GAAG,aAAa,CAAC;YAEjC,mBAAmB;YACnB,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAEnC,oBAAoB;YACpB,IAAI,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAChD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAEnC,4BAA4B;YAC5B,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;YAEzD,0BAA0B;YAC1B,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAC5C,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAClC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAEnD,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjD,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAEjD,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnC,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACnC,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAClC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,uCAAuC,EAAE,GAAG,EAAE;YAC/C,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,aAAa,CAAC;YAEjC,IAAI,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAChD,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAEjC,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAC5C,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAEjC,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAC5C,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,4BAA4B,EAAE,GAAG,EAAE;QAC1C,IAAA,YAAE,EAAC,oDAAoD,EAAE,GAAG,EAAE;YAC5D,IAAA,gBAAM,EAAC,6BAAgB,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC7C,IAAA,gBAAM,EAAC,6BAAgB,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,aAAa;QACvE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kDAAkD,EAAE,GAAG,EAAE;YAC1D,IAAA,gBAAM,EAAC,2BAAc,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;YAC7C,IAAA,gBAAM,EAAC,2BAAc,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,WAAW;QAC9D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,wDAAwD,EAAE,GAAG,EAAE;YAChE,IAAA,gBAAM,EAAC,iCAAoB,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAClD,IAAA,gBAAM,EAAC,iCAAoB,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC,CAAC,SAAS;QACvE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,2CAA2C,EAAE,GAAG,EAAE;YACnD,MAAM,UAAU,GAAG,YAAY,CAAC;YAEhC,mBAAmB;YACnB,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC3B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,6BAAgB,CAAC,CAAC;gBAC5D,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;YAED,oBAAoB;YACpB,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,6BAAgB,CAAC,CAAC;YAC5D,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,IAAA,YAAE,EAAC,gDAAgD,EAAE,GAAG,EAAE;YACxD,MAAM,MAAM,GAAG,IAAA,+BAAkB,EAAC,cAAc,EAAE,6BAAgB,CAAC,CAAC;YACpE,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,mDAAmD,EAAE,GAAG,EAAE;YAC3D,MAAM,UAAU,GAAG,aAAa,CAAC;YACjC,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAEnD,kBAAkB;YAClB,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAEnC,sCAAsC;YACtC,MAAM,OAAO,GAAG,IAAA,+BAAkB,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACvD,IAAA,gBAAM,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACjC,IAAA,gBAAM,EAAC,OAAO,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAEnC,kCAAkC;YAClC,MAAM,OAAO,GAAG,IAAA,+BAAkB,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACvD,IAAA,gBAAM,EAAC,OAAO,EAAE,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,IAAA,YAAE,EAAC,iDAAiD,EAAE,GAAG,EAAE;YACzD,MAAM,UAAU,GAAG,YAAY,CAAC;YAChC,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAEnD,mBAAmB;YACnB,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAEnC,oBAAoB;YACpB,IAAI,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAChD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAEnC,QAAQ;YACR,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,QAAQ,CAAC,CAAC;YAE5C,0BAA0B;YAC1B,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAC5C,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAClC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,8BAA8B,EAAE,GAAG,EAAE;YACtC,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YAEnD,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjC,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjC,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAEjC,IAAA,+BAAkB,GAAE,CAAC;YAErB,yBAAyB;YACzB,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjD,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YACjD,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;YAEjD,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,OAAO,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAClC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,wBAAwB,EAAE,GAAG,EAAE;QACtC,IAAA,YAAE,EAAC,uCAAuC,EAAE,GAAG,EAAE;YAC/C,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,WAAW,CAAC;YAE/B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAElD,uEAAuE;YACvE,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,eAAe,CAAC,EAAE,CAAC,CAAC;YAC7C,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kDAAkD,EAAE,KAAK,IAAI,EAAE;YAChE,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,EAAE,CAAC,CAAC,kBAAkB;YACrE,MAAM,UAAU,GAAG,oBAAoB,CAAC;YAExC,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnD,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,EAAE,CAAC,UAAU,CAAC,OAAO,EAAE,GAAG,CAAC,CAAC,CAAC;YAEzD,MAAM,OAAO,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAEnD,wDAAwD;YACxD,IAAA,gBAAM,EAAC,OAAO,CAAC,SAAS,CAAC,CAAC,mBAAmB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,sBAAsB,EAAE,GAAG,EAAE;QACpC,IAAA,YAAE,EAAC,+CAA+C,EAAE,GAAG,EAAE;YACvD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,qBAAqB,EAAE;gBACjD,OAAO,EAAE;oBACP,iBAAiB,EAAE,uBAAuB;iBAC3C;aACF,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,IAAA,wBAAW,EAAC,OAAO,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yCAAyC,EAAE,GAAG,EAAE;YACjD,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,qBAAqB,EAAE;gBACjD,OAAO,EAAE;oBACP,WAAW,EAAE,aAAa;iBAC3B;aACF,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,IAAA,wBAAW,EAAC,OAAO,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,6DAA6D,EAAE,GAAG,EAAE;YACrE,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,qBAAqB,EAAE;gBACjD,OAAO,EAAE;oBACP,kBAAkB,EAAE,aAAa;iBAClC;aACF,CAAC,CAAC;YAEH,MAAM,EAAE,GAAG,IAAA,wBAAW,EAAC,OAAO,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kDAAkD,EAAE,GAAG,EAAE;YAC1D,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,qBAAqB,CAAC,CAAC;YAEnD,MAAM,EAAE,GAAG,IAAA,wBAAW,EAAC,OAAO,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,EAAE,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;QAC7B,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,sDAAsD,EAAE,GAAG,EAAE;YAC9D,MAAM,OAAO,GAAG,IAAI,OAAO,EAAE,CAAC;YAC9B,OAAO,CAAC,GAAG,CAAC,iBAAiB,EAAE,aAAa,CAAC,CAAC;YAC9C,OAAO,CAAC,GAAG,CAAC,WAAW,EAAE,aAAa,CAAC,CAAC;YACxC,OAAO,CAAC,GAAG,CAAC,kBAAkB,EAAE,aAAa,CAAC,CAAC;YAE/C,MAAM,OAAO,GAAG,IAAI,OAAO,CAAC,qBAAqB,EAAE,EAAE,OAAO,EAAE,CAAC,CAAC;YAEhE,MAAM,EAAE,GAAG,IAAA,wBAAW,EAAC,OAAO,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,YAAY,EAAE,GAAG,EAAE;QAC1B,IAAA,YAAE,EAAC,6CAA6C,EAAE,KAAK,IAAI,EAAE;YAC3D,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,EAAE,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACpD,MAAM,UAAU,GAAG,iBAAiB,CAAC;YAErC,MAAM,QAAQ,GAAG,KAAK,CAAC,IAAI,CAAC,EAAE,MAAM,EAAE,EAAE,EAAE,EAAE,GAAG,EAAE,CAC/C,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CACnC,CAAC;YAEF,MAAM,OAAO,GAAG,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;YAE5C,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;YACjD,MAAM,OAAO,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;YAElD,IAAA,gBAAM,EAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAChC,IAAA,gBAAM,EAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iCAAiC,EAAE,GAAG,EAAE;YACzC,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,WAAW,CAAC;YAE/B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAClD,gEAAgE;YAChE,wCAAwC;YACxC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACnC,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC/B,IAAA,gBAAM,EAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iCAAiC,EAAE,GAAG,EAAE;YACzC,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,IAAI,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,EAAE,CAAC,CAAC,WAAW;YAC7E,MAAM,UAAU,GAAG,mBAAmB,CAAC;YAEvC,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAClC,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,eAAe,CAAC,KAAK,CAAC,CAAC,CAAC,uBAAuB;QAC1E,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yCAAyC,EAAE,GAAG,EAAE;YACjD,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACrD,MAAM,UAAU,GAAG,YAAY,CAAC;YAEhC,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,GAAG,EAAE,CAAC,EAAE,EAAE,CAAC;gBAC7B,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;gBAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YACpC,CAAC;YAED,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAClD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,6BAA6B,EAAE,GAAG,EAAE;QAC3C,IAAA,YAAE,EAAC,0CAA0C,EAAE,GAAG,EAAE;YAClD,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,aAAa,CAAC;YAEjC,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAElD,IAAA,gBAAM,EAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC7B,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YAC/B,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACjC,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;QAC9C,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,qDAAqD,EAAE,GAAG,EAAE;YAC7D,MAAM,MAAM,GAAG,EAAE,WAAW,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,CAAC;YACnD,MAAM,UAAU,GAAG,YAAY,CAAC;YAEhC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YACnC,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAEnC,MAAM,MAAM,GAAG,IAAA,2BAAc,EAAC,UAAU,EAAE,MAAM,CAAC,CAAC;YAElD,IAAA,gBAAM,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YACnC,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,eAAe,CAAC,CAAC,CAAC,CAAC;YAC5C,IAAA,gBAAM,EAAC,MAAM,CAAC,SAAS,CAAC,CAAC,mBAAmB,CAAC,EAAE,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\__tests__\\rate-limit.test.ts"],"sourcesContent":["/**\n * ðŸ›¡ï¸ RATE LIMITING TESTS\n * Comprehensive test suite for rate limiting functionality\n */\n\nimport { afterEach, beforeEach, describe, expect, it } from \"@jest/globals\";\nimport {\n  API_RATE_LIMIT,\n  checkRateLimit,\n  clearAllRateLimits,\n  getClientIp,\n  getRateLimitStatus,\n  LOGIN_RATE_LIMIT,\n  resetRateLimit,\n  SENSITIVE_RATE_LIMIT,\n} from \"../rate-limit\";\n\ndescribe(\"ðŸ›¡ï¸ Rate Limiting\", () => {\n  beforeEach(() => {\n    clearAllRateLimits();\n  });\n\n  afterEach(() => {\n    clearAllRateLimits();\n  });\n\n  describe(\"Basic Rate Limiting\", () => {\n    it(\"should allow requests within limit\", () => {\n      const config = { maxRequests: 5, windowMs: 60000 };\n      const identifier = \"test-user-1\";\n\n      for (let i = 0; i < 5; i++) {\n        const result = checkRateLimit(identifier, config);\n        expect(result.allowed).toBe(true);\n        expect(result.remaining).toBe(4 - i);\n        expect(result.current).toBe(i + 1);\n      }\n    });\n\n    it(\"should block requests exceeding limit\", () => {\n      const config = { maxRequests: 3, windowMs: 60000 };\n      const identifier = \"test-user-2\";\n\n      // First 3 requests should be allowed\n      for (let i = 0; i < 3; i++) {\n        const result = checkRateLimit(identifier, config);\n        expect(result.allowed).toBe(true);\n      }\n\n      // 4th request should be blocked\n      const result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(false);\n      expect(result.remaining).toBe(0);\n      expect(result.current).toBe(4);\n    });\n\n    it(\"should reset after time window expires\", async () => {\n      const config = { maxRequests: 2, windowMs: 100 }; // 100ms window\n      const identifier = \"test-user-3\";\n\n      // Use up the limit\n      checkRateLimit(identifier, config);\n      checkRateLimit(identifier, config);\n\n      // Should be blocked\n      let result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(false);\n\n      // Wait for window to expire\n      await new Promise((resolve) => setTimeout(resolve, 150));\n\n      // Should be allowed again\n      result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(true);\n      expect(result.current).toBe(1);\n    });\n\n    it(\"should handle different identifiers separately\", () => {\n      const config = { maxRequests: 2, windowMs: 60000 };\n\n      const result1 = checkRateLimit(\"user-1\", config);\n      const result2 = checkRateLimit(\"user-2\", config);\n\n      expect(result1.allowed).toBe(true);\n      expect(result2.allowed).toBe(true);\n      expect(result1.current).toBe(1);\n      expect(result2.current).toBe(1);\n    });\n\n    it(\"should return correct remaining count\", () => {\n      const config = { maxRequests: 5, windowMs: 60000 };\n      const identifier = \"test-user-4\";\n\n      let result = checkRateLimit(identifier, config);\n      expect(result.remaining).toBe(4);\n\n      result = checkRateLimit(identifier, config);\n      expect(result.remaining).toBe(3);\n\n      result = checkRateLimit(identifier, config);\n      expect(result.remaining).toBe(2);\n    });\n  });\n\n  describe(\"Pre-configured Rate Limits\", () => {\n    it(\"LOGIN_RATE_LIMIT should have correct configuration\", () => {\n      expect(LOGIN_RATE_LIMIT.maxRequests).toBe(5);\n      expect(LOGIN_RATE_LIMIT.windowMs).toBe(15 * 60 * 1000); // 15 minutes\n    });\n\n    it(\"API_RATE_LIMIT should have correct configuration\", () => {\n      expect(API_RATE_LIMIT.maxRequests).toBe(100);\n      expect(API_RATE_LIMIT.windowMs).toBe(60 * 1000); // 1 minute\n    });\n\n    it(\"SENSITIVE_RATE_LIMIT should have correct configuration\", () => {\n      expect(SENSITIVE_RATE_LIMIT.maxRequests).toBe(10);\n      expect(SENSITIVE_RATE_LIMIT.windowMs).toBe(60 * 60 * 1000); // 1 hour\n    });\n\n    it(\"should enforce LOGIN_RATE_LIMIT correctly\", () => {\n      const identifier = \"login-test\";\n\n      // Allow 5 requests\n      for (let i = 0; i < 5; i++) {\n        const result = checkRateLimit(identifier, LOGIN_RATE_LIMIT);\n        expect(result.allowed).toBe(true);\n      }\n\n      // Block 6th request\n      const result = checkRateLimit(identifier, LOGIN_RATE_LIMIT);\n      expect(result.allowed).toBe(false);\n    });\n  });\n\n  describe(\"Rate Limit Status\", () => {\n    it(\"should return null for non-existent identifier\", () => {\n      const status = getRateLimitStatus(\"non-existent\", LOGIN_RATE_LIMIT);\n      expect(status).toBeNull();\n    });\n\n    it(\"should return current status without incrementing\", () => {\n      const identifier = \"status-test\";\n      const config = { maxRequests: 5, windowMs: 60000 };\n\n      // Make 2 requests\n      checkRateLimit(identifier, config);\n      checkRateLimit(identifier, config);\n\n      // Check status (should not increment)\n      const status1 = getRateLimitStatus(identifier, config);\n      expect(status1?.current).toBe(2);\n      expect(status1?.remaining).toBe(3);\n\n      // Check again (should still be 2)\n      const status2 = getRateLimitStatus(identifier, config);\n      expect(status2?.current).toBe(2);\n    });\n  });\n\n  describe(\"Rate Limit Reset\", () => {\n    it(\"should reset rate limit for specific identifier\", () => {\n      const identifier = \"reset-test\";\n      const config = { maxRequests: 3, windowMs: 60000 };\n\n      // Use up the limit\n      checkRateLimit(identifier, config);\n      checkRateLimit(identifier, config);\n      checkRateLimit(identifier, config);\n\n      // Should be blocked\n      let result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(false);\n\n      // Reset\n      resetRateLimit(identifier, config.windowMs);\n\n      // Should be allowed again\n      result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(true);\n      expect(result.current).toBe(1);\n    });\n\n    it(\"should clear all rate limits\", () => {\n      const config = { maxRequests: 2, windowMs: 60000 };\n\n      checkRateLimit(\"user-1\", config);\n      checkRateLimit(\"user-2\", config);\n      checkRateLimit(\"user-3\", config);\n\n      clearAllRateLimits();\n\n      // All should start fresh\n      const result1 = checkRateLimit(\"user-1\", config);\n      const result2 = checkRateLimit(\"user-2\", config);\n      const result3 = checkRateLimit(\"user-3\", config);\n\n      expect(result1.current).toBe(1);\n      expect(result2.current).toBe(1);\n      expect(result3.current).toBe(1);\n    });\n  });\n\n  describe(\"Reset Time Calculation\", () => {\n    it(\"should calculate reset time correctly\", () => {\n      const config = { maxRequests: 5, windowMs: 60000 };\n      const identifier = \"time-test\";\n\n      const result = checkRateLimit(identifier, config);\n\n      // Reset time should be approximately 60 seconds (with small tolerance)\n      expect(result.resetTime).toBeGreaterThan(55);\n      expect(result.resetTime).toBeLessThanOrEqual(60);\n    });\n\n    it(\"should decrease reset time with subsequent calls\", async () => {\n      const config = { maxRequests: 5, windowMs: 5000 }; // 5 second window\n      const identifier = \"time-decrease-test\";\n\n      const result1 = checkRateLimit(identifier, config);\n      await new Promise((resolve) => setTimeout(resolve, 500));\n\n      const result2 = checkRateLimit(identifier, config);\n\n      // After 500ms, reset time should be at least 500ms less\n      expect(result2.resetTime).toBeLessThanOrEqual(result1.resetTime);\n    });\n  });\n\n  describe(\"Client IP Extraction\", () => {\n    it(\"should extract IP from x-forwarded-for header\", () => {\n      const request = new Request(\"https://example.com\", {\n        headers: {\n          \"x-forwarded-for\": \"192.168.1.1, 10.0.0.1\",\n        },\n      });\n\n      const ip = getClientIp(request);\n      expect(ip).toBe(\"192.168.1.1\");\n    });\n\n    it(\"should extract IP from x-real-ip header\", () => {\n      const request = new Request(\"https://example.com\", {\n        headers: {\n          \"x-real-ip\": \"192.168.1.2\",\n        },\n      });\n\n      const ip = getClientIp(request);\n      expect(ip).toBe(\"192.168.1.2\");\n    });\n\n    it(\"should extract IP from cf-connecting-ip header (Cloudflare)\", () => {\n      const request = new Request(\"https://example.com\", {\n        headers: {\n          \"cf-connecting-ip\": \"192.168.1.3\",\n        },\n      });\n\n      const ip = getClientIp(request);\n      expect(ip).toBe(\"192.168.1.3\");\n    });\n\n    it(\"should return 'unknown' if no IP headers present\", () => {\n      const request = new Request(\"https://example.com\");\n\n      const ip = getClientIp(request);\n      expect(ip).toBe(\"unknown\");\n    });\n\n    it(\"should prioritize x-forwarded-for over other headers\", () => {\n      const headers = new Headers();\n      headers.set(\"x-forwarded-for\", \"192.168.1.1\");\n      headers.set(\"x-real-ip\", \"192.168.1.2\");\n      headers.set(\"cf-connecting-ip\", \"192.168.1.3\");\n\n      const request = new Request(\"https://example.com\", { headers });\n\n      const ip = getClientIp(request);\n      expect(ip).toBe(\"192.168.1.1\");\n    });\n  });\n\n  describe(\"Edge Cases\", () => {\n    it(\"should handle concurrent requests correctly\", async () => {\n      const config = { maxRequests: 10, windowMs: 60000 };\n      const identifier = \"concurrent-test\";\n\n      const requests = Array.from({ length: 15 }, () =>\n        checkRateLimit(identifier, config)\n      );\n\n      const results = await Promise.all(requests);\n\n      const allowed = results.filter((r) => r.allowed);\n      const blocked = results.filter((r) => !r.allowed);\n\n      expect(allowed.length).toBe(10);\n      expect(blocked.length).toBe(5);\n    });\n\n    it(\"should handle zero max requests\", () => {\n      const config = { maxRequests: 0, windowMs: 60000 };\n      const identifier = \"zero-test\";\n\n      const result = checkRateLimit(identifier, config);\n      // With 0 max requests, first request creates entry with count=1\n      // which is > 0, so it should be blocked\n      expect(result.allowed).toBe(false);\n      expect(result.current).toBe(1);\n      expect(result.limit).toBe(0);\n    });\n\n    it(\"should handle very large window\", () => {\n      const config = { maxRequests: 5, windowMs: 1000 * 60 * 60 * 24 }; // 24 hours\n      const identifier = \"large-window-test\";\n\n      const result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(true);\n      expect(result.resetTime).toBeGreaterThan(86000); // ~24 hours in seconds\n    });\n\n    it(\"should handle rapid successive requests\", () => {\n      const config = { maxRequests: 100, windowMs: 60000 };\n      const identifier = \"rapid-test\";\n\n      for (let i = 0; i < 100; i++) {\n        const result = checkRateLimit(identifier, config);\n        expect(result.allowed).toBe(true);\n      }\n\n      const result = checkRateLimit(identifier, config);\n      expect(result.allowed).toBe(false);\n    });\n  });\n\n  describe(\"Rate Limit Response Headers\", () => {\n    it(\"should include correct limit information\", () => {\n      const config = { maxRequests: 5, windowMs: 60000 };\n      const identifier = \"header-test\";\n\n      const result = checkRateLimit(identifier, config);\n\n      expect(result.limit).toBe(5);\n      expect(result.current).toBe(1);\n      expect(result.remaining).toBe(4);\n      expect(result.resetTime).toBeGreaterThan(0);\n    });\n\n    it(\"should provide retry-after information when blocked\", () => {\n      const config = { maxRequests: 2, windowMs: 60000 };\n      const identifier = \"retry-test\";\n\n      checkRateLimit(identifier, config);\n      checkRateLimit(identifier, config);\n\n      const result = checkRateLimit(identifier, config);\n\n      expect(result.allowed).toBe(false);\n      expect(result.resetTime).toBeGreaterThan(0);\n      expect(result.resetTime).toBeLessThanOrEqual(60);\n    });\n  });\n});\n"],"version":3}