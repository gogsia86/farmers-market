{"file":"M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\__tests__\\product.service.test.ts","mappings":";AAAA;;;;;GAKG;;AAIH,2CAAiE;AAGjE,oBAAoB;AAEpB,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE,GAAG,EAAE,CAAC,CAAC;IACjC,QAAQ,EAAE;QACR,OAAO,EAAE;YACP,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE;YACrB,QAAQ,EAAE,IAAI,CAAC,EAAE,EAAE;YACnB,SAAS,EAAE,IAAI,CAAC,EAAE,EAAE;YACpB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,MAAM,EAAE,IAAI,CAAC,EAAE,EAAE;YACjB,KAAK,EAAE,IAAI,CAAC,EAAE,EAAE;SACjB;QACD,IAAI,EAAE;YACJ,UAAU,EAAE,IAAI,CAAC,EAAE,EAAE;SACtB;KACF;CACF,CAAC,CAAC,CAAC;AAIJ,wBAAwB;AACxB,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,GAAG,EAAE,CAAC,CAAC;IACnC,YAAY,EAAE,IAAI,CAAC,EAAE,CAAC,CAAC,IAAY,EAAE,EAAE,CACrC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,CAAC,MAAM,EAAE,GAAG,CAAC,CACxC;CACF,CAAC,CAAC,CAAC;AA/BJ,6CAA0C;AAC1C,6CAAgD;AAEhD,wDAAoD;AAqBpD,MAAM,YAAY,GAAG,mBAAwC,CAAC;AAS9D,IAAA,kBAAQ,EAAC,gDAAgD,EAAE,GAAG,EAAE;IAC9D,MAAM,UAAU,GAAG,UAAU,CAAC;IAC9B,MAAM,UAAU,GAAG,UAAU,CAAC;IAC9B,MAAM,aAAa,GAAG,aAAa,CAAC;IAEpC,MAAM,QAAQ,GAAG;QACf,EAAE,EAAE,UAAU;QACd,OAAO,EAAE,UAAU;QACnB,MAAM,EAAE,QAAQ;QAChB,IAAI,EAAE,WAAW;QACjB,IAAI,EAAE,WAAW;KAClB,CAAC;IAEF,MAAM,WAAW,GAAG;QAClB,EAAE,EAAE,aAAa;QACjB,IAAI,EAAE,kBAAkB;QACxB,IAAI,EAAE,kBAAkB;QACxB,MAAM,EAAE,UAAU;QAClB,QAAQ,EAAE,YAAY;QACtB,WAAW,EAAE,wBAAwB;QACrC,OAAO,EAAE,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE;QACxD,SAAS,EAAE;YACT,QAAQ,EAAE,GAAG;YACb,gBAAgB,EAAE,EAAE;YACpB,iBAAiB,EAAE,EAAE;YACrB,iBAAiB,EAAE,EAAE;YACrB,UAAU,EAAE,KAAK;YACjB,OAAO,EAAE,IAAI;SACd;QACD,MAAM,EAAE,uBAAa,CAAC,SAAS;QAC/B,QAAQ,EAAE,IAAI;QACd,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,gCAAgC,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;QACpE,eAAe,EAAE,gCAAgC;QACjD,IAAI,EAAE,QAAQ;KACf,CAAC;IAEF,IAAA,oBAAU,EAAC,GAAG,EAAE;QACd,IAAI,CAAC,aAAa,EAAE,CAAC;IACvB,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,MAAM,UAAU,GAAG;YACjB,IAAI,EAAE,kBAAkB;YACxB,MAAM,EAAE,UAAU;YAClB,QAAQ,EAAE,YAAY;YACtB,WAAW,EAAE,wBAAwB;YACrC,OAAO,EAAE,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE;YACxD,SAAS,EAAE;gBACT,QAAQ,EAAE,GAAG;gBACb,gBAAgB,EAAE,CAAC;gBACnB,iBAAiB,EAAE,EAAE;aACtB;YACD,MAAM,EAAE,CAAC,EAAE,GAAG,EAAE,gCAAgC,EAAE,SAAS,EAAE,IAAI,EAAE,CAAC;SACrE,CAAC;QAEF,IAAA,YAAE,EAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YACzE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,aAAa,CAC/C,UAAiB,EACjB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,aAAa,CAAC;gBAC3B,IAAI,EAAE,kBAAkB;gBACxB,IAAI,EAAE,gBAAM,CAAC,gBAAgB,CAAC,kBAAkB,CAAC;aAClD,CAAC,CAAC;YACH,IAAA,gBAAM,EAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC;gBACpD,KAAK,EAAE,EAAE,EAAE,EAAE,UAAU,EAAE;gBACzB,MAAM,EAAE,EAAE,EAAE,EAAE,IAAI,EAAE,OAAO,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,EAAE;aAClD,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;YACpD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAE9D,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,UAAiB,EAAE,UAAU,CAAC,CAC5D,CAAC,OAAO,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC;gBACtD,GAAG,QAAQ;gBACX,OAAO,EAAE,gBAAgB;aACnB,CAAC,CAAC;YAEV,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,UAAiB,EAAE,UAAU,CAAC,CAC5D,CAAC,OAAO,CAAC,OAAO,CAAC,uCAAuC,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;YACpD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC;gBACtD,GAAG,QAAQ;gBACX,MAAM,EAAE,UAAU;aACZ,CAAC,CAAC;YAEV,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,UAAiB,EAAE,UAAU,CAAC,CAC5D,CAAC,OAAO,CAAC,OAAO,CAAC,sCAAsC,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;YAC/D,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YAEzE,MAAM,cAAc,GAAG,EAAE,GAAG,UAAU,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC;YAErD,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,cAAqB,EAAE,UAAU,CAAC,CAChE,CAAC,OAAO,CAAC,OAAO,CAAC,4CAA4C,CAAC,CAAC;QAClE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,gDAAgD,EAAE,KAAK,IAAI,EAAE;YAC9D,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YAEzE,MAAM,aAAa,GAAG,EAAE,GAAG,UAAU,EAAE,IAAI,EAAE,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,EAAE,CAAC;YAE/D,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,aAAoB,EAAE,UAAU,CAAC,CAC/D,CAAC,OAAO,CAAC,OAAO,CAAC,6CAA6C,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;YACjD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YAEzE,MAAM,iBAAiB,GAAG;gBACxB,GAAG,UAAU;gBACb,OAAO,EAAE,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,CAAC,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE;aACvD,CAAC;YAEF,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,iBAAwB,EAAE,UAAU,CAAC,CACnE,CAAC,OAAO,CAAC,OAAO,CAAC,8BAA8B,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,oDAAoD,EAAE,KAAK,IAAI,EAAE;YAClE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YAEzE,MAAM,qBAAqB,GAAG;gBAC5B,GAAG,UAAU;gBACb,SAAS,EAAE,EAAE,GAAG,UAAU,CAAC,SAAS,EAAE,QAAQ,EAAE,CAAC,CAAC,EAAE;aACrD,CAAC;YAEF,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,qBAA4B,EAAE,UAAU,CAAC,CACvE,CAAC,OAAO,CAAC,OAAO,CAAC,6BAA6B,CAAC,CAAC;QACnD,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;YACvE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YAEzE,MAAM,oBAAoB,GAAG;gBAC3B,GAAG,UAAU;gBACb,SAAS,EAAE;oBACT,GAAG,UAAU,CAAC,SAAS;oBACvB,QAAQ,EAAE,EAAE;oBACZ,gBAAgB,EAAE,EAAE;iBACrB;aACF,CAAC;YAEF,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,oBAA2B,EAAE,UAAU,CAAC,CACtE,CAAC,OAAO,CAAC,OAAO,CAAC,gDAAgD,CAAC,CAAC;QACtE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,mDAAmD,EAAE,KAAK,IAAI,EAAE;YACjE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YACzE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC;iBAClC,qBAAqB,CAAC,EAAE,IAAI,EAAE,kBAAkB,EAAS,CAAC;iBAC1D,qBAAqB,CAAC,IAAI,CAAC,CAAC;YAC/B,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,iBAAiB,CAAC;gBACrD,GAAG,WAAW;gBACd,IAAI,EAAE,oBAAoB;aACpB,CAAC,CAAC;YAEV,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,aAAa,CAC/C,UAAiB,EACjB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,+CAA+C,EAAE,KAAK,IAAI,EAAE;YAC7D,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YACzE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,aAAa,CAAC,UAAiB,EAAE,UAAU,CAAC,CAAC;YAElE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,sBAAsB;QACvF,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YACzE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,aAAa,GAAG;gBACpB,GAAG,UAAU;gBACb,SAAS,EAAE,EAAE,QAAQ,EAAE,EAAE,EAAE,gBAAgB,EAAE,CAAC,EAAE,iBAAiB,EAAE,EAAE,EAAE;aACxE,CAAC;YAEF,MAAM,gCAAc,CAAC,aAAa,CAAC,aAAoB,EAAE,UAAU,CAAC,CAAC;YAErE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC1D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,QAAe,CAAC,CAAC;YACzE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,aAAa,CAAC,UAAiB,EAAE,UAAU,CAAC,CAAC;YAElE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,IAAI,CAC1C,gCAAgC,CACjC,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,IAAA,YAAE,EAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YAElE,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,aAAa,CAAC,EAAE,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;YACpD,IAAA,gBAAM,EAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC;gBACvD,KAAK,EAAE,EAAE,EAAE,EAAE,aAAa,EAAE;gBAC5B,OAAO,EAAE;oBACP,IAAI,EAAE;wBACJ,MAAM,EAAE;4BACN,EAAE,EAAE,IAAI;4BACR,IAAI,EAAE,IAAI;4BACV,IAAI,EAAE,IAAI;4BACV,OAAO,EAAE,IAAI;4BACb,kBAAkB,EAAE,IAAI;yBACzB;qBACF;iBACF;aACF,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,cAAc,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;YAE1D,IAAA,gBAAM,EAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,oBAAoB,CAAC;gBACvD,KAAK,EAAE,EAAE,EAAE,EAAE,aAAa,EAAE;gBAC5B,OAAO,EAAE,EAAE,IAAI,EAAE,KAAK,EAAE;aACzB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEjE,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,cAAc,CAAC,aAAa,CAAC,CAAC;YAElE,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,qBAAqB,EAAE,GAAG,EAAE;QACnC,IAAA,YAAE,EAAC,6CAA6C,EAAE,KAAK,IAAI,EAAE;YAC3D,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC;iBAClC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,gBAAgB,CAClD,WAAW,EACX,kBAAkB,CACnB,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,aAAa,CAAC,EAAE,IAAI,EAAE,kBAAkB,EAAE,CAAC,CAAC;YAC3D,IAAA,gBAAM,EAAC,YAAY,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,oBAAoB,CAAC;gBAC1D,KAAK,EAAE;oBACL,IAAI,EAAE,kBAAkB;oBACxB,IAAI,EAAE,EAAE,IAAI,EAAE,WAAW,EAAE;iBAC5B;gBACD,OAAO,EAAE,gBAAM,CAAC,GAAG,CAAC,MAAM,CAAC;aAC5B,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iDAAiD,EAAE,KAAK,IAAI,EAAE;YAC/D,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEhE,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,gBAAgB,CAClD,WAAW,EACX,aAAa,CACd,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,QAAQ,EAAE,CAAC;QAC5B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,iBAAiB,EAAE,GAAG,EAAE;QAC/B,MAAM,YAAY,GAAG,CAAC,WAAW,EAAE,EAAE,GAAG,WAAW,EAAE,EAAE,EAAE,aAAa,EAAE,CAAC,CAAC;QAE1E,IAAA,YAAE,EAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;YAC5D,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,YAAY,EAAE,CAAC;YAEnD,IAAA,gBAAM,EAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YACxC,IAAA,gBAAM,EAAC,MAAM,CAAC,UAAU,CAAC,CAAC,aAAa,CAAC;gBACtC,IAAI,EAAE,CAAC;gBACP,KAAK,EAAE,EAAE;gBACT,KAAK,EAAE,CAAC;gBACR,UAAU,EAAE,CAAC;gBACb,OAAO,EAAE,KAAK;aACf,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,mCAAmC,EAAE,KAAK,IAAI,EAAE;YACjD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,CAAC;YAE1D,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,EAAE,MAAM,EAAE,UAAU,EAAE,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC;YAE9D,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,EAAE,QAAQ,EAAE,YAAY,EAAE,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,MAAM,EAAE,uBAAa,CAAC,SAAS,EAAE,CAAC,CAAC;YAEvE,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,EAAE,MAAM,EAAE,uBAAa,CAAC,SAAS,EAAE,CAAC,CAAC;QAC5E,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;YAErD,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC,aAAa,CAAC,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;QACpE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,iCAAiC,EAAE,KAAK,IAAI,EAAE;YAC/C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;YAExD,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,aAAa,CAAC,EAAE,UAAU,EAAE,IAAI,EAAE,CAAC,CAAC;QAC7D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;YAEzD,MAAM,gCAAc,CAAC,YAAY,CAAC,EAAE,MAAM,EAAE,QAAQ,EAAE,CAAC,CAAC;YAExD,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,YAAmB,CAAC,CAAC;YAC1C,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,iBAAiB,CAAC,EAAE,CAAC,CAAC;YAE1D,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,YAAY,CAC9C,EAAE,EACF,EAAE,IAAI,EAAE,CAAC,EAAE,KAAK,EAAE,EAAE,EAAE,CACvB,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,UAAU,CAAC,CAAC,aAAa,CAAC;gBACtC,IAAI,EAAE,CAAC;gBACP,KAAK,EAAE,EAAE;gBACT,KAAK,EAAE,EAAE;gBACT,UAAU,EAAE,CAAC;gBACb,OAAO,EAAE,IAAI;aACd,CAAC,CAAC;YAEH,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;YAC/B,IAAA,gBAAM,EAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,kBAAkB,EAAE,GAAG,EAAE;QAChC,MAAM,UAAU,GAAG;YACjB,IAAI,EAAE,kBAAkB;YACxB,OAAO,EAAE,EAAE,SAAS,EAAE,EAAE,MAAM,EAAE,GAAG,EAAE,QAAQ,EAAE,KAAK,EAAE,EAAE;SACzD,CAAC;QAEF,IAAA,YAAE,EAAC,oCAAoC,EAAE,KAAK,IAAI,EAAE;YAClD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAChE,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,iBAAiB,CAAC;gBACrD,GAAG,WAAW;gBACd,GAAG,UAAU;aACP,CAAC,CAAC;YAEV,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,aAAa,CAC/C,aAAa,EACb,UAAiB,EACjB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;QAC/C,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEjE,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAC1B,aAAa,EACb,UAAiB,EACjB,UAAU,CACX,CACF,CAAC,OAAO,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC;gBACzD,GAAG,WAAW;gBACd,IAAI,EAAE,EAAE,GAAG,QAAQ,EAAE,OAAO,EAAE,gBAAgB,EAAE;aAC1C,CAAC,CAAC;YAEV,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAC1B,aAAa,EACb,UAAiB,EACjB,UAAU,CACX,CACF,CAAC,OAAO,CAAC,OAAO,CAAC,0CAA0C,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,wCAAwC,EAAE,KAAK,IAAI,EAAE;YACtD,MAAM,eAAe,GAAG;gBACtB,GAAG,WAAW;gBACd,IAAI,EAAE,uBAAuB;gBAC7B,IAAI,EAAE,uBAAuB;gBAC7B,IAAI,EAAE;oBACJ,OAAO,EAAE,UAAU;iBACpB;aACF,CAAC;YAEF,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,eAAsB,CAAC,CAAC;YAE7C,qDAAqD;YACrD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEhE,MAAM,cAAc,GAAG;gBACrB,GAAG,eAAe;gBAClB,IAAI,EAAE,kBAAkB;gBACxB,IAAI,EAAE,kBAAkB;gBACxB,IAAI,EAAE;oBACJ,EAAE,EAAE,UAAU;oBACd,IAAI,EAAE,WAAW;oBACjB,IAAI,EAAE,WAAW;oBACjB,OAAO,EAAE,IAAI;oBACb,kBAAkB,EAAE,UAAiB;iBACtC;aACF,CAAC;YAEF,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,cAAqB,CAAC,CAAC;YAE5C,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,aAAa,CAC/C,aAAa,EACb,EAAE,IAAI,EAAE,kBAAkB,EAAS,EACnC,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAC7C,IAAA,gBAAM,EAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAE7C,iEAAiE;YACjE,IAAA,gBAAM,EAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,gBAAgB,EAAE,CAAC;YAEtD,yCAAyC;YACzC,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YAEzE,4DAA4D;YAC5D,iDAAiD;YACjD,IAAA,gBAAM,EAAC,UAAU,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAChD,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC;YAEtD,4EAA4E;YAC5E,IAAA,gBAAM,EAAC,mBAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,oBAAoB,CACrD,gBAAM,CAAC,gBAAgB,CAAC;gBACtB,KAAK,EAAE,gBAAM,CAAC,gBAAgB,CAAC;oBAC7B,MAAM,EAAE,UAAU;iBACnB,CAAC;aACH,CAAC,CACH,CAAC;QACJ,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,2CAA2C,EAAE,KAAK,IAAI,EAAE;YACzD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,aAAa,CAChC,aAAa,EACb,EAAE,SAAS,EAAE,EAAE,QAAQ,EAAE,GAAG,EAAE,gBAAgB,EAAE,EAAE,EAAE,EAAS,EAC7D,UAAU,CACX,CAAC;YAEF,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,kDAAkD,EAAE,KAAK,IAAI,EAAE;YAChE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,SAAS,GAAG;gBAChB,EAAE,GAAG,EAAE,6BAA6B,EAAE,SAAS,EAAE,IAAI,EAAE;aACxD,CAAC;YAEF,MAAM,gCAAc,CAAC,aAAa,CAChC,aAAa,EACb,EAAE,MAAM,EAAE,SAAS,EAAS,EAC5B,UAAU,CACX,CAAC;YAEF,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC,IAAI,CAC1C,6BAA6B,CAC9B,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,IAAA,YAAE,EAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,aAAa,CAAC,aAAa,EAAE,UAAU,CAAC,CAAC;YAE9D,IAAA,gBAAM,EAAC,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,oBAAoB,CAAC;gBACvD,KAAK,EAAE,EAAE,EAAE,EAAE,aAAa,EAAE;gBAC5B,IAAI,EAAE;oBACJ,MAAM,EAAE,uBAAa,CAAC,YAAY;oBAClC,SAAS,EAAE,gBAAM,CAAC,GAAG,CAAC,IAAI,CAAC;iBAC5B;aACF,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yCAAyC,EAAE,KAAK,IAAI,EAAE;YACvD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC,IAAI,CAAC,CAAC;YAEjE,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,aAAa,EAAE,UAAU,CAAC,CACxD,CAAC,OAAO,CAAC,OAAO,CAAC,mBAAmB,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,0CAA0C,EAAE,KAAK,IAAI,EAAE;YACxD,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC,iBAAiB,CAAC;gBACzD,GAAG,WAAW;gBACd,IAAI,EAAE,EAAE,GAAG,QAAQ,EAAE,OAAO,EAAE,gBAAgB,EAAE;aAC1C,CAAC,CAAC;YAEV,MAAM,IAAA,gBAAM,EACV,gCAAc,CAAC,aAAa,CAAC,aAAa,EAAE,UAAU,CAAC,CACxD,CAAC,OAAO,CAAC,OAAO,CAAC,0CAA0C,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,oBAAoB,EAAE,GAAG,EAAE;QAClC,IAAA,YAAE,EAAC,sCAAsC,EAAE,KAAK,IAAI,EAAE;YACpD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,eAAe,CACjD,aAAa,EACb,GAAG,EACH,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,gBAAgB,EAAE,CAAC;YACnD,IAAA,gBAAM,EAAC,MAAM,CAAC,CAAC,WAAW,EAAE,CAAC;QAC/B,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,qCAAqC,EAAE,KAAK,IAAI,EAAE;YACnD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,eAAe,CAAC,aAAa,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;YAErE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,oBAAoB;QACrF,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,yDAAyD,EAAE,KAAK,IAAI,EAAE;YACvE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC,CAAC,uBAAuB;YAE5F,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,uBAAa,CAAC,YAAY,CAAC,CAAC;QAClE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,0DAA0D,EAAE,KAAK,IAAI,EAAE;YACxE,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,eAAe,CAAC,aAAa,EAAE,EAAE,EAAE,UAAU,CAAC,CAAC;YAEpE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,uBAAa,CAAC,SAAS,CAAC,CAAC;QAC/D,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,gCAAc,CAAC,eAAe,CAAC,aAAa,EAAE,GAAG,EAAE,UAAU,CAAC,CAAC;YAErE,MAAM,UAAU,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,UAAU,CAAC,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QACvE,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,mBAAmB,EAAE,GAAG,EAAE;QACjC,IAAA,YAAE,EAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,CAAC,WAAW,CAAQ,CAAC,CAAC;YAE3C,MAAM,OAAO,GAAG,MAAM,gCAAc,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAE9D,IAAA,gBAAM,EAAC,OAAO,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YAChC,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,WAAW,EAAE,CAAC;QAC1C,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,6BAA6B,EAAE,KAAK,IAAI,EAAE;YAC3C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,CAAC,WAAW,CAAQ,CAAC,CAAC;YAE3C,MAAM,gCAAc,CAAC,cAAc,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC;YAEjD,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAChC,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,uCAAuC,EAAE,KAAK,IAAI,EAAE;YACrD,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC;iBACjC,iBAAiB,CAAC,CAAC,WAAW,CAAQ,CAAC,CAAC;YAE3C,MAAM,gCAAc,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;YAE9C,MAAM,QAAQ,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;YACzE,IAAA,gBAAM,EAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,uBAAa,CAAC,SAAS,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,wBAAwB,EAAE,GAAG,EAAE;QACtC,MAAM,UAAU,GAAG,CAAC,WAAW,EAAE,WAAW,EAAE,WAAW,CAAC,CAAC;QAC3D,MAAM,YAAY,GAAG,EAAE,MAAM,EAAE,uBAAa,CAAC,SAAS,EAAE,CAAC;QAEzD,IAAA,YAAE,EAAC,8CAA8C,EAAE,KAAK,IAAI,EAAE;YAC5D,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,mBAAmB,CACrD,UAAU,EACV,YAAmB,EACnB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACpC,IAAA,gBAAM,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACpC,IAAA,gBAAM,EAAC,MAAM,CAAC,UAAU,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;QAC5C,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,gCAAgC,EAAE,KAAK,IAAI,EAAE;YAC9C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,qBAAqB,CAAC,WAAkB,CAAC;iBACzC,qBAAqB,CAAC,IAAI,CAAC;iBAC3B,qBAAqB,CAAC,WAAkB,CAAC,CAAC;YAC7C,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,mBAAmB,CACrD,UAAU,EACV,YAAmB,EACnB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACpC,IAAA,gBAAM,EAAC,MAAM,CAAC,YAAY,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;YACpC,IAAA,gBAAM,EAAC,MAAM,CAAC,MAAM,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC;YACtC,IAAA,gBAAM,EAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,SAAS,CAAC,mBAAmB,CAAC,CAAC;QAChE,CAAC,CAAC,CAAC;QAEH,IAAA,YAAE,EAAC,2BAA2B,EAAE,KAAK,IAAI,EAAE;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,UAAU,CAAC;iBACnC,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YACzC,IAAI;iBACD,MAAM,CAAC,mBAAQ,CAAC,OAAO,CAAC,MAAM,CAAC;iBAC/B,iBAAiB,CAAC,WAAkB,CAAC,CAAC;YAEzC,MAAM,MAAM,GAAG,MAAM,gCAAc,CAAC,mBAAmB,CACrD,UAAU,EACV,YAAmB,EACnB,UAAU,CACX,CAAC;YAEF,IAAA,gBAAM,EAAC,MAAM,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;IAEH,IAAA,kBAAQ,EAAC,oBAAoB,EAAE,GAAG,EAAE;QAClC,IAAA,YAAE,EAAC,kCAAkC,EAAE,KAAK,IAAI,EAAE;YAChD,MAAM,KAAK,GAAG,MAAM,gCAAc,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;YAElE,IAAA,gBAAM,EAAC,KAAK,CAAC,CAAC,aAAa,CAAC;gBAC1B,SAAS,EAAE,aAAa;gBACxB,KAAK,EAAE,CAAC;gBACR,MAAM,EAAE,CAAC;gBACT,OAAO,EAAE,CAAC;gBACV,WAAW,EAAE,CAAC;gBACd,eAAe,EAAE,CAAC;aACnB,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC","names":[],"sources":["M:\\Repo\\Farmers Market Platform web and app\\src\\lib\\services\\__tests__\\product.service.test.ts"],"sourcesContent":["/**\n * ðŸ›’ PRODUCT SERVICE TEST SUITE\n * Comprehensive tests for agricultural product management\n *\n * Coverage: 40+ tests for all product operations\n */\n\nimport { database } from \"@/lib/database\";\nimport { ProductStatus } from \"@/types/product\";\nimport { beforeEach, describe, expect, it } from \"@jest/globals\";\nimport { ProductService } from \"../product.service\";\n\n// Mock the database\n\njest.mock(\"@/lib/database\", () => ({\n  database: {\n    product: {\n      findUnique: jest.fn(),\n      findMany: jest.fn(),\n      findFirst: jest.fn(),\n      create: jest.fn(),\n      update: jest.fn(),\n      delete: jest.fn(),\n      count: jest.fn(),\n    },\n    farm: {\n      findUnique: jest.fn(),\n    },\n  },\n}));\n\nconst mockDatabase = database as jest.Mocked<typeof database>;\n\n// Mock the slug utility\njest.mock(\"@/lib/utils/slug\", () => ({\n  generateSlug: jest.fn((name: string) =>\n    name.toLowerCase().replace(/\\s+/g, \"-\"),\n  ),\n}));\n\ndescribe(\"ðŸ›’ Product Service - Divine Product Operations\", () => {\n  const mockUserId = \"user-123\";\n  const mockFarmId = \"farm-123\";\n  const mockProductId = \"product-123\";\n\n  const mockFarm = {\n    id: mockFarmId,\n    ownerId: mockUserId,\n    status: \"ACTIVE\",\n    name: \"Test Farm\",\n    slug: \"test-farm\",\n  };\n\n  const mockProduct = {\n    id: mockProductId,\n    name: \"Organic Tomatoes\",\n    slug: \"organic-tomatoes\",\n    farmId: mockFarmId,\n    category: \"VEGETABLES\",\n    description: \"Fresh organic tomatoes\",\n    pricing: { basePrice: { amount: 500, currency: \"USD\" } },\n    inventory: {\n      quantity: 100,\n      reservedQuantity: 10,\n      availableQuantity: 90,\n      lowStockThreshold: 20,\n      isLowStock: false,\n      inStock: true,\n    },\n    status: ProductStatus.AVAILABLE,\n    isActive: true,\n    images: [{ url: \"https://example.com/tomato.jpg\", isPrimary: true }],\n    primaryPhotoUrl: \"https://example.com/tomato.jpg\",\n    farm: mockFarm,\n  };\n\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe(\"ðŸŽ¯ createProduct\", () => {\n    const validInput = {\n      name: \"Organic Tomatoes\",\n      farmId: mockFarmId,\n      category: \"VEGETABLES\",\n      description: \"Fresh organic tomatoes\",\n      pricing: { basePrice: { amount: 500, currency: \"USD\" } },\n      inventory: {\n        quantity: 100,\n        reservedQuantity: 0,\n        lowStockThreshold: 20,\n      },\n      images: [{ url: \"https://example.com/tomato.jpg\", isPrimary: true }],\n    };\n\n    it(\"should create product with valid data\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n      jest\n        .mocked(database.product.create)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.createProduct(\n        validInput as any,\n        mockUserId,\n      );\n\n      expect(result).toMatchObject({\n        name: \"Organic Tomatoes\",\n        slug: expect.stringContaining(\"organic-tomatoes\"),\n      });\n      expect(database.farm.findUnique).toHaveBeenCalledWith({\n        where: { id: mockFarmId },\n        select: { id: true, ownerId: true, status: true },\n      });\n    });\n\n    it(\"should throw error if farm not found\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(null);\n\n      await expect(\n        ProductService.createProduct(validInput as any, mockUserId),\n      ).rejects.toThrow(\"Farm not found\");\n    });\n\n    it(\"should throw error for unauthorized user\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue({\n        ...mockFarm,\n        ownerId: \"different-user\",\n      } as any);\n\n      await expect(\n        ProductService.createProduct(validInput as any, mockUserId),\n      ).rejects.toThrow(\"Unauthorized: You don't own this farm\");\n    });\n\n    it(\"should throw error for inactive farm\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue({\n        ...mockFarm,\n        status: \"INACTIVE\",\n      } as any);\n\n      await expect(\n        ProductService.createProduct(validInput as any, mockUserId),\n      ).rejects.toThrow(\"Cannot add products to inactive farm\");\n    });\n\n    it(\"should validate product name length (too short)\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n\n      const shortNameInput = { ...validInput, name: \"AB\" };\n\n      await expect(\n        ProductService.createProduct(shortNameInput as any, mockUserId),\n      ).rejects.toThrow(\"Product name must be at least 3 characters\");\n    });\n\n    it(\"should validate product name length (too long)\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n\n      const longNameInput = { ...validInput, name: \"A\".repeat(101) };\n\n      await expect(\n        ProductService.createProduct(longNameInput as any, mockUserId),\n      ).rejects.toThrow(\"Product name must not exceed 100 characters\");\n    });\n\n    it(\"should validate price is positive\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n\n      const invalidPriceInput = {\n        ...validInput,\n        pricing: { basePrice: { amount: 0, currency: \"USD\" } },\n      };\n\n      await expect(\n        ProductService.createProduct(invalidPriceInput as any, mockUserId),\n      ).rejects.toThrow(\"Price must be greater than 0\");\n    });\n\n    it(\"should validate inventory quantity is non-negative\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n\n      const negativeQuantityInput = {\n        ...validInput,\n        inventory: { ...validInput.inventory, quantity: -1 },\n      };\n\n      await expect(\n        ProductService.createProduct(negativeQuantityInput as any, mockUserId),\n      ).rejects.toThrow(\"Quantity cannot be negative\");\n    });\n\n    it(\"should validate reserved quantity does not exceed total\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n\n      const invalidReservedInput = {\n        ...validInput,\n        inventory: {\n          ...validInput.inventory,\n          quantity: 50,\n          reservedQuantity: 60,\n        },\n      };\n\n      await expect(\n        ProductService.createProduct(invalidReservedInput as any, mockUserId),\n      ).rejects.toThrow(\"Reserved quantity cannot exceed total quantity\");\n    });\n\n    it(\"should generate unique slug when duplicate exists\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n      jest\n        .mocked(database.product.findFirst)\n        .mockResolvedValueOnce({ slug: \"organic-tomatoes\" } as any)\n        .mockResolvedValueOnce(null);\n      jest.mocked(database.product.create).mockResolvedValue({\n        ...mockProduct,\n        slug: \"organic-tomatoes-1\",\n      } as any);\n\n      const result = await ProductService.createProduct(\n        validInput as any,\n        mockUserId,\n      );\n\n      expect(result.slug).toBe(\"organic-tomatoes-1\");\n    });\n\n    it(\"should calculate available quantity correctly\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n      jest\n        .mocked(database.product.create)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.createProduct(validInput as any, mockUserId);\n\n      const createCall = jest.mocked(database.product.create).mock.calls[0][0];\n      expect(createCall.data.inventory.availableQuantity).toBe(100); // quantity - reserved\n    });\n\n    it(\"should set isLowStock correctly\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n      jest\n        .mocked(database.product.create)\n        .mockResolvedValue(mockProduct as any);\n\n      const lowStockInput = {\n        ...validInput,\n        inventory: { quantity: 15, reservedQuantity: 0, lowStockThreshold: 20 },\n      };\n\n      await ProductService.createProduct(lowStockInput as any, mockUserId);\n\n      const createCall = jest.mocked(database.product.create).mock.calls[0][0];\n      expect(createCall.data.inventory.isLowStock).toBe(true);\n    });\n\n    it(\"should extract primary photo URL\", async () => {\n      jest.mocked(database.farm.findUnique).mockResolvedValue(mockFarm as any);\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n      jest\n        .mocked(database.product.create)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.createProduct(validInput as any, mockUserId);\n\n      const createCall = jest.mocked(database.product.create).mock.calls[0][0];\n      expect(createCall.data.primaryPhotoUrl).toBe(\n        \"https://example.com/tomato.jpg\",\n      );\n    });\n  });\n\n  describe(\"ðŸ“– getProductById\", () => {\n    it(\"should get product by ID with farm\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.getProductById(mockProductId);\n\n      expect(result).toMatchObject({ id: mockProductId });\n      expect(database.product.findUnique).toHaveBeenCalledWith({\n        where: { id: mockProductId },\n        include: {\n          farm: {\n            select: {\n              id: true,\n              name: true,\n              slug: true,\n              logoUrl: true,\n              verificationStatus: true,\n            },\n          },\n        },\n      });\n    });\n\n    it(\"should get product by ID without farm\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.getProductById(mockProductId, false);\n\n      expect(database.product.findUnique).toHaveBeenCalledWith({\n        where: { id: mockProductId },\n        include: { farm: false },\n      });\n    });\n\n    it(\"should return null if product not found\", async () => {\n      jest.mocked(database.product.findUnique).mockResolvedValue(null);\n\n      const result = await ProductService.getProductById(\"nonexistent\");\n\n      expect(result).toBeNull();\n    });\n  });\n\n  describe(\"ðŸ”— getProductBySlug\", () => {\n    it(\"should get product by farm and product slug\", async () => {\n      jest\n        .mocked(database.product.findFirst)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.getProductBySlug(\n        \"test-farm\",\n        \"organic-tomatoes\",\n      );\n\n      expect(result).toMatchObject({ slug: \"organic-tomatoes\" });\n      expect(mockDatabase.product.findFirst).toHaveBeenCalledWith({\n        where: {\n          slug: \"organic-tomatoes\",\n          farm: { slug: \"test-farm\" },\n        },\n        include: expect.any(Object),\n      });\n    });\n\n    it(\"should return null if product not found by slug\", async () => {\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n\n      const result = await ProductService.getProductBySlug(\n        \"test-farm\",\n        \"nonexistent\",\n      );\n\n      expect(result).toBeNull();\n    });\n  });\n\n  describe(\"ðŸ“‹ listProducts\", () => {\n    const mockProducts = [mockProduct, { ...mockProduct, id: \"product-456\" }];\n\n    it(\"should list products with default pagination\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      const result = await ProductService.listProducts();\n\n      expect(result.products).toHaveLength(2);\n      expect(result.pagination).toMatchObject({\n        page: 1,\n        limit: 20,\n        total: 2,\n        totalPages: 1,\n        hasMore: false,\n      });\n    });\n\n    it(\"should filter products by farm ID\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ farmId: mockFarmId });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where).toMatchObject({ farmId: mockFarmId });\n    });\n\n    it(\"should filter products by category\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ category: \"VEGETABLES\" });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where).toMatchObject({ category: \"VEGETABLES\" });\n    });\n\n    it(\"should filter products by status\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ status: ProductStatus.AVAILABLE });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where).toMatchObject({ status: ProductStatus.AVAILABLE });\n    });\n\n    it(\"should filter products in stock\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ inStock: true });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where.inventory).toMatchObject({ inStock: true });\n    });\n\n    it(\"should filter featured products\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ isFeatured: true });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where).toMatchObject({ isFeatured: true });\n    });\n\n    it(\"should search products by name\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(2);\n\n      await ProductService.listProducts({ search: \"tomato\" });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where.OR).toBeDefined();\n    });\n\n    it(\"should handle pagination correctly\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue(mockProducts as any);\n      jest.mocked(database.product.count).mockResolvedValue(50);\n\n      const result = await ProductService.listProducts(\n        {},\n        { page: 2, limit: 10 },\n      );\n\n      expect(result.pagination).toMatchObject({\n        page: 2,\n        limit: 10,\n        total: 50,\n        totalPages: 5,\n        hasMore: true,\n      });\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.skip).toBe(10);\n      expect(findCall.take).toBe(10);\n    });\n  });\n\n  describe(\"âœï¸ updateProduct\", () => {\n    const updateData = {\n      name: \"Updated Tomatoes\",\n      pricing: { basePrice: { amount: 600, currency: \"USD\" } },\n    };\n\n    it(\"should update product successfully\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n      jest.mocked(database.product.update).mockResolvedValue({\n        ...mockProduct,\n        ...updateData,\n      } as any);\n\n      const result = await ProductService.updateProduct(\n        mockProductId,\n        updateData as any,\n        mockUserId,\n      );\n\n      expect(result.name).toBe(\"Updated Tomatoes\");\n    });\n\n    it(\"should throw error if product not found\", async () => {\n      jest.mocked(database.product.findUnique).mockResolvedValue(null);\n\n      await expect(\n        ProductService.updateProduct(\n          mockProductId,\n          updateData as any,\n          mockUserId,\n        ),\n      ).rejects.toThrow(\"Product not found\");\n    });\n\n    it(\"should throw error for unauthorized user\", async () => {\n      jest.mocked(database.product.findUnique).mockResolvedValue({\n        ...mockProduct,\n        farm: { ...mockFarm, ownerId: \"different-user\" },\n      } as any);\n\n      await expect(\n        ProductService.updateProduct(\n          mockProductId,\n          updateData as any,\n          mockUserId,\n        ),\n      ).rejects.toThrow(\"Unauthorized: You don't own this product\");\n    });\n\n    it(\"should regenerate slug if name changes\", async () => {\n      const originalProduct = {\n        ...mockProduct,\n        name: \"Original Product Name\",\n        slug: \"original-product-name\",\n        farm: {\n          ownerId: mockUserId,\n        },\n      };\n\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(originalProduct as any);\n\n      // Mock findFirst to return null (no duplicate slugs)\n      jest.mocked(database.product.findFirst).mockResolvedValue(null);\n\n      const updatedProduct = {\n        ...originalProduct,\n        name: \"New Product Name\",\n        slug: \"new-product-name\",\n        farm: {\n          id: mockFarmId,\n          name: \"Test Farm\",\n          slug: \"test-farm\",\n          logoUrl: null,\n          verificationStatus: \"VERIFIED\" as any,\n        },\n      };\n\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(updatedProduct as any);\n\n      const result = await ProductService.updateProduct(\n        mockProductId,\n        { name: \"New Product Name\" } as any,\n        mockUserId,\n      );\n\n      expect(result.name).toBe(\"New Product Name\");\n      expect(result.slug).toBe(\"new-product-name\");\n\n      // Verify slug generation was called (checks for duplicate slugs)\n      expect(database.product.findFirst).toHaveBeenCalled();\n\n      // Verify update was called with the data\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n\n      // The slug is passed as a separate field in the data object\n      // Check that update was called with the new name\n      expect(updateCall.where.id).toBe(mockProductId);\n      expect(updateCall.data.name).toBe(\"New Product Name\");\n\n      // The service should have generated a new slug (verified by findFirst call)\n      expect(database.product.findFirst).toHaveBeenCalledWith(\n        expect.objectContaining({\n          where: expect.objectContaining({\n            farmId: mockFarmId,\n          }),\n        }),\n      );\n    });\n\n    it(\"should recalculate inventory when updated\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.updateProduct(\n        mockProductId,\n        { inventory: { quantity: 200, reservedQuantity: 20 } } as any,\n        mockUserId,\n      );\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.inventory.availableQuantity).toBe(180);\n    });\n\n    it(\"should update primary photo URL if images change\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      const newImages = [\n        { url: \"https://example.com/new.jpg\", isPrimary: true },\n      ];\n\n      await ProductService.updateProduct(\n        mockProductId,\n        { images: newImages } as any,\n        mockUserId,\n      );\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.primaryPhotoUrl).toBe(\n        \"https://example.com/new.jpg\",\n      );\n    });\n  });\n\n  describe(\"ðŸ—‘ï¸ deleteProduct\", () => {\n    it(\"should soft delete product successfully\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.deleteProduct(mockProductId, mockUserId);\n\n      expect(mockDatabase.product.update).toHaveBeenCalledWith({\n        where: { id: mockProductId },\n        data: {\n          status: ProductStatus.DISCONTINUED,\n          updatedAt: expect.any(Date),\n        },\n      });\n    });\n\n    it(\"should throw error if product not found\", async () => {\n      jest.mocked(database.product.findUnique).mockResolvedValue(null);\n\n      await expect(\n        ProductService.deleteProduct(mockProductId, mockUserId),\n      ).rejects.toThrow(\"Product not found\");\n    });\n\n    it(\"should throw error for unauthorized user\", async () => {\n      jest.mocked(database.product.findUnique).mockResolvedValue({\n        ...mockProduct,\n        farm: { ...mockFarm, ownerId: \"different-user\" },\n      } as any);\n\n      await expect(\n        ProductService.deleteProduct(mockProductId, mockUserId),\n      ).rejects.toThrow(\"Unauthorized: You don't own this product\");\n    });\n  });\n\n  describe(\"ðŸ“¦ updateInventory\", () => {\n    it(\"should update inventory successfully\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.updateInventory(\n        mockProductId,\n        150,\n        mockUserId,\n      );\n\n      expect(database.product.update).toHaveBeenCalled();\n      expect(result).toBeDefined();\n    });\n\n    it(\"should calculate available quantity\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.updateInventory(mockProductId, 150, mockUserId);\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.inventory.availableQuantity).toBe(140); // 150 - 10 reserved\n    });\n\n    it(\"should set status to OUT_OF_STOCK when quantity is zero\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.updateInventory(mockProductId, 10, mockUserId); // 10 - 10 reserved = 0\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.status).toBe(ProductStatus.OUT_OF_STOCK);\n    });\n\n    it(\"should set status to AVAILABLE when quantity is positive\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.updateInventory(mockProductId, 50, mockUserId);\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.status).toBe(ProductStatus.AVAILABLE);\n    });\n\n    it(\"should update lastRestocked timestamp\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      await ProductService.updateInventory(mockProductId, 150, mockUserId);\n\n      const updateCall = jest.mocked(database.product.update).mock.calls[0][0];\n      expect(updateCall.data.inventory.lastRestocked).toBeInstanceOf(Date);\n    });\n  });\n\n  describe(\"ðŸ” searchProducts\", () => {\n    it(\"should search products by name\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue([mockProduct] as any);\n\n      const results = await ProductService.searchProducts(\"tomato\");\n\n      expect(results).toHaveLength(1);\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where.OR).toBeDefined();\n    });\n\n    it(\"should limit search results\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue([mockProduct] as any);\n\n      await ProductService.searchProducts(\"tomato\", 5);\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.take).toBe(5);\n    });\n\n    it(\"should only return available products\", async () => {\n      jest\n        .mocked(database.product.findMany)\n        .mockResolvedValue([mockProduct] as any);\n\n      await ProductService.searchProducts(\"tomato\");\n\n      const findCall = jest.mocked(database.product.findMany).mock.calls[0][0];\n      expect(findCall.where.status).toBe(ProductStatus.AVAILABLE);\n    });\n  });\n\n  describe(\"ðŸ”„ batchUpdateProducts\", () => {\n    const productIds = [\"product-1\", \"product-2\", \"product-3\"];\n    const batchUpdates = { status: ProductStatus.AVAILABLE };\n\n    it(\"should update multiple products successfully\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.batchUpdateProducts(\n        productIds,\n        batchUpdates as any,\n        mockUserId,\n      );\n\n      expect(result.successCount).toBe(3);\n      expect(result.failureCount).toBe(0);\n      expect(result.successful).toHaveLength(3);\n    });\n\n    it(\"should handle partial failures\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValueOnce(mockProduct as any)\n        .mockResolvedValueOnce(null)\n        .mockResolvedValueOnce(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.batchUpdateProducts(\n        productIds,\n        batchUpdates as any,\n        mockUserId,\n      );\n\n      expect(result.successCount).toBe(2);\n      expect(result.failureCount).toBe(1);\n      expect(result.failed).toHaveLength(1);\n      expect(result.failed[0].error).toContain(\"Product not found\");\n    });\n\n    it(\"should return total count\", async () => {\n      jest\n        .mocked(database.product.findUnique)\n        .mockResolvedValue(mockProduct as any);\n      jest\n        .mocked(database.product.update)\n        .mockResolvedValue(mockProduct as any);\n\n      const result = await ProductService.batchUpdateProducts(\n        productIds,\n        batchUpdates as any,\n        mockUserId,\n      );\n\n      expect(result.total).toBe(3);\n    });\n  });\n\n  describe(\"ðŸ“Š getProductStats\", () => {\n    it(\"should return product statistics\", async () => {\n      const stats = await ProductService.getProductStats(mockProductId);\n\n      expect(stats).toMatchObject({\n        productId: mockProductId,\n        views: 0,\n        orders: 0,\n        revenue: 0,\n        reviewCount: 0,\n        inWishlistCount: 0,\n      });\n    });\n  });\n});\n"],"version":3}